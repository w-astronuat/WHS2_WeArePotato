{"info": {"author": "", "author_email": "", "bugtrack_url": null, "classifiers": ["Environment :: Console", "License :: OSI Approved :: GNU General Public License v3 (GPLv3)", "Operating System :: MacOS :: MacOS X", "Operating System :: Microsoft :: Windows", "Operating System :: POSIX", "Programming Language :: Python :: 2.7", "Programming Language :: Python :: 3.4", "Programming Language :: Python :: 3.5", "Programming Language :: Python :: 3.6", "Topic :: Security"], "description": "# 0wned\n\n[![Build Status](https://travis-ci.org/mschwager/0wned.svg?branch=master)](https://travis-ci.org/mschwager/0wned)\n[![Build Status](https://ci.appveyor.com/api/projects/status/github/mschwager/0wned?branch=master&svg=true)](https://ci.appveyor.com/project/mschwager/0wned/branch/master)\n\nPython packages allow for [arbitrary code execution](https://en.wikipedia.org/wiki/Arbitrary_code_execution)\nat **run time** as well as **install time**. Code execution at **run time** makes\nsense because, well, that's what code does. But executing code at **install time**\nis a lesser known feature within the Python packaging ecosystem, and a\npotentially much more dangerous one.\n\nTo test it out let's download this repository:\n\n```\n$ git clone https://github.com/mschwager/0wned.git\n```\n\n*Don't worry, there's nothing malicious going on, you can [take a look at what's happening yourself](https://github.com/mschwager/0wned/blob/master/setup.py).*\n\nNow let's install the package:\n\n```\n$ sudo python -m pip install 0wned/\n$ cat /0wned\nCreated '/0wned' with user 'root' at 1536011622\n```\n\n**During `pip` installation `0wned` was able to successfully write to the root\ndirectory! This means that `0wned` can do anything as the root or administrative\nuser.**\n\nWe can reduce the impact of this issue by installing packages with the `--user` flag:\n\n```\n$ python -m pip install --user 0wned/\n$ cat ~/0wned\nCreated '/home/tempuser/0wned' with user 'tempuser' at 1536011624\n```\n\n# Prevention\n\nYou should always be wary of Python packages you're installing on your system,\nespecially when using root/administrative privileges. There are a few ways to help\nmitigate these types of attacks:\n\n* Install only [binary distribution Python wheels](https://pythonwheels.com/) using the `--only-binary :all:` flag. This avoids arbitrary code execution on installation (avoids `setup.py`).\n* As mentioned above, install packages [with the local user](https://packaging.python.org/tutorials/installing-packages/#installing-to-the-user-site) using the `--user` flag.\n* Install packages in [hash-checking mode](https://pip.pypa.io/en/stable/reference/pip_install/#hash-checking-mode) using the `--require-hashes` flag. This will protect against remote tampering and ensure you're getting the package you intend to.\n* Double check that you've spelled the package name correctly. There may be malicious packages [typosquatting](https://en.wikipedia.org/wiki/Typosquatting) under a similar name.\n\n# Details of the Attack\n\nYou can hook almost any `pip` command by extending the correct `setuptools` module.\n\nFor example, `0wned` takes advantage of the `install` class to do its thing:\n\n```python\nfrom setuptools import setup\nfrom setuptools.command.install import install\n\nclass PostInstallCommand(install):\n    def run(self):\n        # Insert code here\n        install.run(self)\n\nsetup(\n    ...\n    cmdclass={\n        'install': PostInstallCommand,\n    },\n    ...\n)\n```\n\nAnd when `pip install` is run our custom `PostInstallCommand` class will be invoked.\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/mschwager/0wneg", "keywords": "", "license": "GPLv3", "maintainer": "", "maintainer_email": "", "name": "0wneg", "package_url": "https://pypi.org/project/0wneg/", "platform": null, "project_url": "https://pypi.org/project/0wneg/", "project_urls": {"Homepage": "https://github.com/mschwager/0wneg"}, "release_url": "https://pypi.org/project/0wneg/0.9.0/", "requires_dist": null, "requires_python": "", "summary": "Code execution via Python package installation.", "version": "0.9.0", "yanked": false, "yanked_reason": null}, "last_serial": 18095387, "releases": {"0.9.0": [{"comment_text": "", "digests": {"blake2b_256": "0021706b3ac35cac579ef357263d09f5bb395811508fed64dc47c793ed36b066", "md5": "73629c5268cc05f590b318fa368c0571", "sha256": "b279f2dfc9af632b968989fe274764cd2ef38bc6b6016cde45db005a19e4991d"}, "downloads": -1, "filename": "0wneg-0.9.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "73629c5268cc05f590b318fa368c0571", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 14815, "upload_time": "2023-05-14T06:42:21", "upload_time_iso_8601": "2023-05-14T06:42:21.351917Z", "url": "https://files.pythonhosted.org/packages/00/21/706b3ac35cac579ef357263d09f5bb395811508fed64dc47c793ed36b066/0wneg-0.9.0-py2.py3-none-any.whl", "yanked": false, "yanked_reason": null}, {"comment_text": "", "digests": {"blake2b_256": "5601a2822a9a42cd72cd8d0487482559b5d1dc164150acd69112c94e88cd7a6e", "md5": "31cdec8bf2fc7188cc6f71f35bb1d292", "sha256": "ce2223b3de9c72343703fb6bd078bc1620b130d0a750db7674115b9f2f51d03d"}, "downloads": -1, "filename": "0wneg-0.9.0.tar.gz", "has_sig": false, "md5_digest": "31cdec8bf2fc7188cc6f71f35bb1d292", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3111, "upload_time": "2023-05-14T06:42:23", "upload_time_iso_8601": "2023-05-14T06:42:23.675735Z", "url": "https://files.pythonhosted.org/packages/56/01/a2822a9a42cd72cd8d0487482559b5d1dc164150acd69112c94e88cd7a6e/0wneg-0.9.0.tar.gz", "yanked": false, "yanked_reason": null}]}, "urls": [{"comment_text": "", "digests": {"blake2b_256": "0021706b3ac35cac579ef357263d09f5bb395811508fed64dc47c793ed36b066", "md5": "73629c5268cc05f590b318fa368c0571", "sha256": "b279f2dfc9af632b968989fe274764cd2ef38bc6b6016cde45db005a19e4991d"}, "downloads": -1, "filename": "0wneg-0.9.0-py2.py3-none-any.whl", "has_sig": false, "md5_digest": "73629c5268cc05f590b318fa368c0571", "packagetype": "bdist_wheel", "python_version": "py2.py3", "requires_python": null, "size": 14815, "upload_time": "2023-05-14T06:42:21", "upload_time_iso_8601": "2023-05-14T06:42:21.351917Z", "url": "https://files.pythonhosted.org/packages/00/21/706b3ac35cac579ef357263d09f5bb395811508fed64dc47c793ed36b066/0wneg-0.9.0-py2.py3-none-any.whl", "yanked": false, "yanked_reason": null}, {"comment_text": "", "digests": {"blake2b_256": "5601a2822a9a42cd72cd8d0487482559b5d1dc164150acd69112c94e88cd7a6e", "md5": "31cdec8bf2fc7188cc6f71f35bb1d292", "sha256": "ce2223b3de9c72343703fb6bd078bc1620b130d0a750db7674115b9f2f51d03d"}, "downloads": -1, "filename": "0wneg-0.9.0.tar.gz", "has_sig": false, "md5_digest": "31cdec8bf2fc7188cc6f71f35bb1d292", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 3111, "upload_time": "2023-05-14T06:42:23", "upload_time_iso_8601": "2023-05-14T06:42:23.675735Z", "url": "https://files.pythonhosted.org/packages/56/01/a2822a9a42cd72cd8d0487482559b5d1dc164150acd69112c94e88cd7a6e/0wneg-0.9.0.tar.gz", "yanked": false, "yanked_reason": null}], "vulnerabilities": []}